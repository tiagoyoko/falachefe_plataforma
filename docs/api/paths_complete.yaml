paths:
  /instance/init:
    post:
      tags:
        - Admininstração
      summary: Criar Instancia
      security:
        - admintoken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Nome da instância
                  example: minha-instancia
                systemName:
                  type: string
                  description: Nome do sistema (opcional, padrão 'uazapiGO' se não informado)
                  example: apilocal
                adminField01:
                  type: string
                  description: Campo administrativo 1 para metadados personalizados (opcional)
                  example: custom-metadata-1
                adminField02:
                  type: string
                  description: Campo administrativo 2 para metadados personalizados (opcional)
                  example: custom-metadata-2
              required:
                - name
      description: >
        Cria uma nova instância do WhatsApp. Para criar uma instância você precisa:


        1. Ter um admintoken válido

        2. Enviar pelo menos o nome da instância

        3. A instância será criada desconectada

        4. Será gerado um token único para autenticação


        Após criar a instância, guarde o token retornado pois ele será necessário

        para todas as outras operações.


        Estados possíveis da instância:


        - `disconnected`: Desconectado do WhatsApp

        - `connecting`: Em processo de conexão

        - `connected`: Conectado e autenticado


        Campos administrativos (adminField01/adminField02) são opcionais e podem ser usados para armazenar metadados
        personalizados. 

        OS valores desses campos são vísiveis para o dono da instancia via token, porém apenas o administrador da api
        (via admin token) pode editá-los.
      responses:
        '200':
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Instance created successfully
                  instance:
                    $ref: ../schemas/instance.yaml#/Instance
                  connected:
                    type: boolean
                    example: false
                  loggedIn:
                    type: boolean
                    example: false
                  name:
                    type: string
                    example: minha-instancia
                  token:
                    type: string
                    example: 123e4567-e89b-12d3-a456-426614174000
                  info:
                    type: string
                    example: This instance will be automatically disconnected and deleted after 1 hour.
        '401':
          description: Token inválido/expirado
        '404':
          description: Instância não encontrada
        '500':
          description: Erro interno
  /instance/all:
    get:
      tags:
        - Admininstração
      summary: Listar todas as instâncias
      security:
        - admintoken: []
      description: |
        Retorna uma lista completa de todas as instâncias do sistema, incluindo:
        - ID e nome de cada instância
        - Status atual (disconnected, connecting, connected)
        - Data de criação
        - Última desconexão e motivo
        - Informações de perfil (se conectado)

        Requer permissões de administrador.
      responses:
        '200':
          description: Lista de instâncias retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/instance.yaml#/Instance
              example:
                - id: r183e2ef9597845
                  name: instancia-1
                  token: abc123xyz
                  status: connected
                  profileName: Meu WhatsApp
                  profilePicUrl: https://example.com/profile.jpg
                  isBusiness: true
                  plataform: Android
                  systemName: uazapi
                  owner: user@example.com
                  created: '2024-01-01T12:00:00.000Z'
                  updated: '2024-01-01T12:30:00.000Z'
                - id: r283e2ef9597846
                  name: instancia-2
                  token: def456xyz
                  status: disconnected
                  lastDisconnect: '2024-01-02T12:00:00.000Z'
                  lastDisconnectReason: manual disconnect
                  created: '2024-01-02T12:00:00.000Z'
                  updated: '2024-01-02T12:30:00.000Z'
        '401':
          description: Token inválido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '403':
          description: Token de administrador inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid AdminToken Header
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Internal server error
  /instance/connect:
    post:
      tags:
        - Instancia
      summary: Conectar instância ao WhatsApp
      description: |
        Inicia o processo de conexão de uma instância ao WhatsApp. Este endpoint:
        1. Requer o token de autenticação da instância
        2. Recebe o número de telefone associado à conta WhatsApp
        3. Gera um QR code caso não passe o campo `phone`
        4. Ou Gera código de pareamento se passar o o campo `phone`
        5. Atualiza o status da instância para "connecting"

        O processo de conexão permanece pendente até que:
        - O QR code seja escaneado no WhatsApp do celular, ou
        - O código de pareamento seja usado no WhatsApp
        - Timeout de 2 minutos para QRCode seja atingido ou 5 minutos para o código de pareamento

        Use o endpoint /instance/status para monitorar o progresso da conexão.

        Estados possíveis da instância:
        - `disconnected`: Desconectado do WhatsApp
        - `connecting`: Em processo de conexão
        - `connected`: Conectado e autenticado

        Exemplo de requisição:
        ```json
        {
          "phone": "5511999999999"
        }
        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                phone:
                  type: string
                  description: 'Número de telefone no formato internacional (ex: 5511999999999)'
                  example: '5511999999999'
                  pattern: ^\d{10,15}$
              required:
                - phone
      responses:
        '200':
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  connected:
                    type: boolean
                    description: Estado atual da conexão
                    example: false
                  loggedIn:
                    type: boolean
                    description: Estado do login
                    example: false
                  jid:
                    type: object
                    description: ID do WhatsApp (quando logado)
                    nullable: true
                    example: null
                  instance:
                    $ref: ../schemas/instance.yaml#/Instance
                    description: Detalhes completos da instância
        '401':
          description: Token inválido/expirado
        '404':
          description: Instância não encontrada
        '429':
          description: Limite de conexões simultâneas atingido
        '500':
          description: Erro interno
  /instance/disconnect:
    post:
      tags:
        - Instancia
      summary: Desconectar instância
      description: |
        Desconecta a instância do WhatsApp, encerrando a sessão atual.
        Esta operação:

        - Encerra a conexão ativa

        - Requer novo QR code para reconectar


        Diferenças entre desconectar e hibernar:

        - Desconectar: Encerra completamente a sessão, exigindo novo login

        - Hibernar: Mantém a sessão ativa, apenas pausa a conexão


        Use este endpoint para:

        1. Encerrar completamente uma sessão

        2. Forçar uma nova autenticação

        3. Limpar credenciais de uma instância

        4. Reiniciar o processo de conexão


        Estados possíveis após desconectar:

        - `disconnected`: Desconectado do WhatsApp

        - `connecting`: Em processo de reconexão (após usar /instance/connect)
    responses:
      '200':
        description: Sucesso
        content:
          application/json:
            schema:
              type: object
              properties:
                instance:
                  $ref: ../schemas/instance.yaml#/Instance
                response:
                  type: string
                  example: Disconnected
                info:
                  type: string
                  example: >-
                    The device has been successfully disconnected from WhatsApp. A new QR code will be required for the
                    next connection.
      '401':
        description: Token inválido/expirado
      '404':
        description: Instância não encontrada
      '500':
        description: Erro interno
  /instance/status:
    get:
      tags:
        - Instancia
      summary: Verificar status da instância
      description: |
        Retorna o status atual de uma instância, incluindo:
        - Estado da conexão (disconnected, connecting, connected)
        - QR code atualizado (se em processo de conexão)
        - Código de pareamento (se disponível)
        - Informações da última desconexão
        - Detalhes completos da instância

        Este endpoint é particularmente útil para:
        1. Monitorar o progresso da conexão
        2. Obter QR codes atualizados durante o processo de conexão
        3. Verificar o estado atual da instância
        4. Identificar problemas de conexão

        Estados possíveis:
        - `disconnected`: Desconectado do WhatsApp
        - `connecting`: Em processo de conexão (aguardando QR code ou código de pareamento)
        - `connected`: Conectado e autenticado com sucesso
      responses:
        '200':
          description: Sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  instance:
                    $ref: ../schemas/instance.yaml#/Instance
                  status:
                    type: object
                    properties:
                      connected:
                        type: boolean
                        description: Indica se está conectado ao WhatsApp
                      loggedIn:
                        type: boolean
                        description: Indica se está autenticado no WhatsApp
                      jid:
                        type: object
                        description: ID do WhatsApp quando conectado
                        nullable: true
              example:
                instance:
                  id: r183e2ef9597845
                  name: minha-instancia
                  status: connected
                  profileName: Meu WhatsApp
                  currentTime: '2024-01-25T12:00:00.000Z'
                status:
                  connected: true
                  loggedIn: true
                  jid:
                    user: '5511999999999'
                    agent: 0
                    device: 0
                    server: s.whatsapp.net
        '401':
          description: Token inválido/expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: instance info not found
        '404':
          description: Instância não encontrada
        '500':
          description: Erro interno
  /instance/updatechatbotsettings:
    post:
      tags:
        - Chatbot Configurações
      summary: Chatbot Configurações
      description: >
        Explicação dos campos:



        - `openai_apikey`: Chave da API OpenAI (começa com "sk-")  


        - `chatbot_enabled`: Habilita/desabilita o chatbot  


        - `chatbot_ignoreGroups`: Define se o chatbot deve ignorar mensagens de grupos  


        - `chatbot_stopConversation`: Palavra-chave que os usuários podem usar para parar o chatbot  


        - `chatbot_stopMinutes`: Por quantos minutos o chatbot deve ficar desativado após receber o comando de parada  


        - `chatbot_stopWhenYouSendMsg`: Por quantos minutos o chatbot deve ficar desativado após você enviar uma
        mensagem fora da API, 0 desliga.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              example:
                openai_apikey: sk-1234567890abcdefghijklmnopqrstuvwxyz
                chatbot_enabled: true
                chatbot_ignoreGroups: true
                chatbot_stopConversation: stop
                chatbot_stopMinutes: 30
                chatbot_stopWhenYouSendMsg: 5
      responses:
        '200':
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/instance.yaml#/Instance
        '401':
          description: Token inválido/expirado
        '404':
          description: Instância não encontrada
        '500':
          description: Erro interno
  /instance/updateFieldsMap:
    post:
      tags:
        - CRM
      summary: Atualizar campos personalizados de leads
      description: |
        Atualiza os campos personalizados (custom fields) de uma instância. 
        Permite configurar até 20 campos personalizados para armazenamento de 
        informações adicionais sobre leads.

        Cada campo pode armazenar até 255 caracteres e aceita qualquer tipo de dado.

        Campos disponíveis:
        - lead_field01 a lead_field20

        Exemplo de uso:
        1. Armazenar informações adicionais sobre leads
        2. Criar campos personalizados para integração com outros sistemas
        3. Armazenar tags ou categorias personalizadas
        4. Manter histórico de interações com o lead

        Exemplo de requisição:
        ```json
        {
          "lead_field01": "nome",
          "lead_field02": "email",
          "lead_field03": "telefone",
          "lead_field04": "cidade",
          "lead_field05": "estado",
          "lead_field06": "idade",
          "lead_field07": "interesses",
          "lead_field08": "origem",
          "lead_field09": "status",
          "lead_field10": "valor",
          "lead_field11": "observacoes",
          "lead_field12": "ultima_interacao",
          "lead_field13": "proximo_contato",
          "lead_field14": "vendedor",
          "lead_field15": "produto_interesse",
          "lead_field16": "fonte_captacao",
          "lead_field17": "score",
          "lead_field18": "tags",
          "lead_field19": "historico",
          "lead_field20": "custom"
        }
        ```

        Exemplo de resposta:
        ```json
        {
          "success": true,
          "message": "Custom fields updated successfully",
          "instance": {
            "id": "r183e2ef9597845",
            "name": "minha-instancia",
            "fieldsMap": {
              "lead_field01": "nome",
              "lead_field02": "email",
              "lead_field03": "telefone",
              "lead_field04": "cidade",
              "lead_field05": "estado",
              "lead_field06": "idade",
              "lead_field07": "interesses",
              "lead_field08": "origem",
              "lead_field09": "status",
              "lead_field10": "valor",
              "lead_field11": "observacoes",
              "lead_field12": "ultima_interacao",
              "lead_field13": "proximo_contato",
              "lead_field14": "vendedor",
              "lead_field15": "produto_interesse",
              "lead_field16": "fonte_captacao",
              "lead_field17": "score",
              "lead_field18": "tags",
              "lead_field19": "historico",
              "lead_field20": "custom"
            }
          }
        }
        ```

        Erros comuns:
        - 400: Campos inválidos ou payload mal formatado
        - 401: Token inválido ou expirado
        - 404: Instância não encontrada
        - 500: Erro ao atualizar campos no banco de dados

        Restrições:
        - Cada campo pode ter no máximo 255 caracteres
        - Campos vazios serão mantidos com seus valores atuais
        - Apenas os campos enviados serão atualizados
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                lead_field01:
                  type: string
                  description: Campo personalizado 01
                  maxLength: 255
                lead_field02:
                  type: string
                  description: Campo personalizado 02
                  maxLength: 255
                lead_field03:
                  type: string
                  description: Campo personalizado 03
                  maxLength: 255
                lead_field04:
                  type: string
                  description: Campo personalizado 04
                  maxLength: 255
                lead_field05:
                  type: string
                  description: Campo personalizado 05
                  maxLength: 255
                lead_field06:
                  type: string
                  description: Campo personalizado 06
                  maxLength: 255
                lead_field07:
                  type: string
                  description: Campo personalizado 07
                  maxLength: 255
                lead_field08:
                  type: string
                  description: Campo personalizado 08
                  maxLength: 255
                lead_field09:
                  type: string
                  description: Campo personalizado 09
                  maxLength: 255
                lead_field10:
                  type: string
                  description: Campo personalizado 10
                  maxLength: 255
                lead_field11:
                  type: string
                  description: Campo personalizado 11
                  maxLength: 255
                lead_field12:
                  type: string
                  description: Campo personalizado 12
                  maxLength: 255
                lead_field13:
                  type: string
                  description: Campo personalizado 13
                  maxLength: 255
                lead_field14:
                  type: string
                  description: Campo personalizado 14
                  maxLength: 255
                lead_field15:
                  type: string
                  description: Campo personalizado 15
                  maxLength: 255
                lead_field16:
                  type: string
                  description: Campo personalizado 16
                  maxLength: 255
                lead_field17:
                  type: string
                  description: Campo personalizado 17
                  maxLength: 255
                lead_field18:
                  type: string
                  description: Campo personalizado 18
                  maxLength: 255
                lead_field19:
                  type: string
                  description: Campo personalizado 19
                  maxLength: 255
                lead_field20:
                  type: string
                  description: Campo personalizado 20
                  maxLength: 255
      responses:
        '200':
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/instance.yaml#/Instance
        '401':
          description: Token inválido/expirado
        '404':
          description: Instância não encontrada
        '500':
          description: Erro interno
  /instance/updateInstanceName:
    post:
      tags:
        - Instancia
      summary: Atualizar nome da instância
      description: "Atualiza o nome de uma instância WhatsApp existente.\nO nome não precisa ser único.\t\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Novo nome para a instância
                  example: Minha Nova Instância 2024!@#
              required:
                - name
      responses:
        '200':
          description: Sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/instance.yaml#/Instance
        '401':
          description: Token inválido/expirado
        '404':
          description: Instância não encontrada
        '500':
          description: Erro interno
  /instance/updateAdminFields:
    post:
      tags:
        - Admininstração
      summary: Atualizar campos administrativos
      security:
        - admintoken: []
      description: >
        Atualiza os campos administrativos (adminField01/adminField02) de uma instância.


        Campos administrativos são opcionais e podem ser usados para armazenar metadados personalizados. 

        Estes campos são persistidos no banco de dados e podem ser utilizados para integrações com outros sistemas ou
        para armazenamento de informações internas.

        OS valores desses campos são vísiveis para o dono da instancia via token, porém apenas o administrador da api
        (via admin token) pode editá-los.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID da instância
                  example: inst_123456
                adminField01:
                  type: string
                  description: Campo administrativo 1
                  example: clientId_456
                adminField02:
                  type: string
                  description: Campo administrativo 2
                  example: integration_xyz
              required:
                - id
      responses:
        '200':
          description: Campos atualizados com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/instance.yaml#/Instance
        '401':
          description: Token de administrador inválido
        '404':
          description: Instância não encontrada
        '500':
          description: Erro interno
  /profile/name:
    post:
      tags:
        - Perfil
      summary: Altera o nome do perfil do WhatsApp
      description: |
        Altera o nome de exibição do perfil da instância do WhatsApp.

        O endpoint realiza:
        - Atualiza o nome do perfil usando o WhatsApp AppState
        - Sincroniza a mudança com o servidor do WhatsApp
        - Retorna confirmação da alteração

        **Importante**: 
        - A instância deve estar conectada ao WhatsApp
        - O nome será visível para todos os contatos
        - Pode haver um limite de alterações por período (conforme WhatsApp)
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Novo nome do perfil do WhatsApp
                  example: Minha Empresa - Atendimento
                  maxLength: 25
      responses:
        '200':
          description: Nome do perfil alterado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Nome do perfil alterado com sucesso
                  profile:
                    type: object
                    properties:
                      name:
                        type: string
                        description: Novo nome do perfil
                        example: Minha Empresa - Atendimento
                      updated_at:
                        type: integer
                        description: Timestamp da alteração (Unix timestamp)
                        example: 1704067200
        '400':
          description: Dados inválidos na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Nome muito longo ou inválido
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '403':
          description: Ação não permitida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Limite de alterações excedido ou conta com restrições
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao alterar nome do perfil
  /profile/image:
    post:
      tags:
        - Perfil
      summary: Altera a imagem do perfil do WhatsApp
      description: |
        Altera a imagem de perfil da instância do WhatsApp.

        O endpoint realiza:
        - Atualiza a imagem do perfil usando 
        - Processa a imagem (URL, base64 ou comando de remoção)
        - Sincroniza a mudança com o servidor do WhatsApp
        - Retorna confirmação da alteração

        **Importante**: 
        - A instância deve estar conectada ao WhatsApp
        - A imagem será visível para todos os contatos
        - A imagem deve estar em formato JPEG e tamanho 640x640 pixels
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  description: |
                    Imagem do perfil. Pode ser:
                    - URL da imagem (http/https)
                    - String base64 da imagem
                    - "remove" ou "delete" para remover a imagem atual
                  example: https://picsum.photos/640/640.jpg
                  oneOf:
                    - description: URL da imagem
                      example: https://picsum.photos/640/640.jpg
                    - description: Imagem em base64
                      example: >-
                        data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k=
                    - description: Comando para remover imagem
                      example: remove
      responses:
        '200':
          description: Imagem do perfil alterada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Imagem do perfil alterada com sucesso
                  profile:
                    type: object
                    properties:
                      image_updated:
                        type: boolean
                        description: Indica se a imagem foi atualizada
                        example: true
                      image_removed:
                        type: boolean
                        description: Indica se a imagem foi removida
                        example: false
                      updated_at:
                        type: integer
                        description: Timestamp da alteração (Unix timestamp)
                        example: 1704067200
        '400':
          description: Dados inválidos na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Formato de imagem inválido ou URL inacessível
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '403':
          description: Ação não permitida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Limite de alterações excedido ou conta com restrições
        '413':
          description: Imagem muito grande
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Imagem muito grande, tamanho máximo permitido excedido
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao alterar imagem do perfil
  /instance:
    delete:
      tags:
        - Instancia
      summary: Deletar instância
      description: |
        Remove a instância do sistema.
      security:
        - token: []
      responses:
        '200':
          description: Instância deletada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Instance Deleted
                  info:
                    type: string
                    example: O dispositivo foi desconectado com sucesso e a instância foi removida do banco de dados.
        '401':
          description: Falha na autenticação
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Não autorizado - Token inválido ou ausente
        '404':
          description: Instância não encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Instância não encontrada
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Falha ao deletar instância
  /instance/privacy:
    get:
      tags:
        - Instancia
      summary: Buscar configurações de privacidade
      description: >
        Busca as configurações de privacidade atuais da instância do WhatsApp.


        **Importante - Diferença entre Status e Broadcast:**


        - **Status**: Refere-se ao recado personalizado que aparece embaixo do nome do usuário (ex: "Disponível",
        "Ocupado", texto personalizado)

        - **Broadcast**: Refere-se ao envio de "stories/reels" (fotos/vídeos temporários)


        **Limitação**: As configurações de privacidade do broadcast (stories/reels) não estão disponíveis para alteração
        via API.


        Retorna todas as configurações de privacidade como quem pode:

        - Adicionar aos grupos

        - Ver visto por último

        - Ver status (recado embaixo do nome)

        - Ver foto de perfil

        - Receber confirmação de leitura

        - Ver status online

        - Fazer chamadas
      operationId: getPrivacySettings
      responses:
        '200':
          description: Configurações de privacidade obtidas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupadd:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode adicionar aos grupos. Valores - all, contacts, contact_blacklist, none
                    example: contacts
                  last:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver visto por último. Valores - all, contacts, contact_blacklist, none
                    example: contacts
                  status:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver status (recado embaixo do nome). Valores - all, contacts, contact_blacklist, none
                    example: contacts
                  profile:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver foto de perfil. Valores - all, contacts, contact_blacklist, none
                    example: contacts
                  readreceipts:
                    type: string
                    enum:
                      - all
                      - none
                    description: Confirmação de leitura. Valores - all, none
                    example: all
                  online:
                    type: string
                    enum:
                      - all
                      - match_last_seen
                    description: Quem pode ver status online. Valores - all, match_last_seen
                    example: all
                  calladd:
                    type: string
                    enum:
                      - all
                      - known
                    description: Quem pode fazer chamadas. Valores - all, known
                    example: all
              examples:
                success:
                  summary: Configurações de privacidade obtidas
                  value:
                    groupadd: contacts
                    last: contacts
                    status: contacts
                    profile: contacts
                    readreceipts: all
                    online: all
                    calladd: all
        '401':
          description: Token de autenticação inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: client not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
    post:
      tags:
        - Instancia
      summary: Alterar configurações de privacidade
      description: >
        Altera uma ou múltiplas configurações de privacidade da instância do WhatsApp de forma otimizada.


        **Importante - Diferença entre Status e Broadcast:**


        - **Status**: Refere-se ao recado personalizado que aparece embaixo do nome do usuário (ex: "Disponível",
        "Ocupado", texto personalizado)

        - **Broadcast**: Refere-se ao envio de "stories/reels" (fotos/vídeos temporários)


        **Limitação**: As configurações de privacidade do broadcast (stories/reels) não estão disponíveis para alteração
        via API.


        **Características:**

        - ✅ **Eficiência**: Altera apenas configurações que realmente mudaram

        - ✅ **Flexibilidade**: Pode alterar uma ou múltiplas configurações na mesma requisição

        - ✅ **Feedback completo**: Retorna todas as configurações atualizadas


        **Formato de entrada:**

        ```json

        {
          "groupadd": "contacts",
          "last": "none",
          "status": "contacts"
        }

        ```


        **Tipos de privacidade disponíveis:**

        - `groupadd`: Quem pode adicionar aos grupos

        - `last`: Quem pode ver visto por último

        - `status`: Quem pode ver status (recado embaixo do nome)

        - `profile`: Quem pode ver foto de perfil

        - `readreceipts`: Confirmação de leitura

        - `online`: Quem pode ver status online

        - `calladd`: Quem pode fazer chamadas


        **Valores possíveis:**

        - `all`: Todos

        - `contacts`: Apenas contatos

        - `contact_blacklist`: Contatos exceto bloqueados

        - `none`: Ninguém

        - `match_last_seen`: Corresponder ao visto por último (apenas para online)

        - `known`: Números conhecidos (apenas para calladd)
      operationId: setPrivacySetting
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupadd:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode adicionar aos grupos. Valores - all, contacts, contact_blacklist, none
                last:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode ver visto por último. Valores - all, contacts, contact_blacklist, none
                status:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode ver status (recado embaixo do nome). Valores - all, contacts, contact_blacklist, none
                profile:
                  type: string
                  enum:
                    - all
                    - contacts
                    - contact_blacklist
                    - none
                  description: Quem pode ver foto de perfil. Valores - all, contacts, contact_blacklist, none
                readreceipts:
                  type: string
                  enum:
                    - all
                    - none
                  description: Confirmação de leitura. Valores - all, none
                online:
                  type: string
                  enum:
                    - all
                    - match_last_seen
                  description: Quem pode ver status online. Valores - all, match_last_seen
                calladd:
                  type: string
                  enum:
                    - all
                    - known
                  description: Quem pode fazer chamadas. Valores - all, known
              minProperties: 1
              additionalProperties: false
            examples:
              single_setting:
                summary: Alterar uma configuração
                value:
                  groupadd: contacts
              multiple_settings:
                summary: Alterar múltiplas configurações
                value:
                  groupadd: contacts
                  last: none
                  status: contacts
                  profile: contacts
              privacy_strict:
                summary: Configuração mais restritiva
                value:
                  groupadd: none
                  last: none
                  status: contacts
                  profile: contacts
                  readreceipts: none
      responses:
        '200':
          description: Configuração de privacidade alterada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupadd:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode adicionar aos grupos. Valores - all, contacts, contact_blacklist, none
                  last:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver visto por último. Valores - all, contacts, contact_blacklist, none
                  status:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver status (recado embaixo do nome). Valores - all, contacts, contact_blacklist, none
                  profile:
                    type: string
                    enum:
                      - all
                      - contacts
                      - contact_blacklist
                      - none
                    description: Quem pode ver foto de perfil. Valores - all, contacts, contact_blacklist, none
                  readreceipts:
                    type: string
                    enum:
                      - all
                      - none
                    description: Confirmação de leitura. Valores - all, none
                  online:
                    type: string
                    enum:
                      - all
                      - match_last_seen
                    description: Quem pode ver status online. Valores - all, match_last_seen
                  calladd:
                    type: string
                    enum:
                      - all
                      - known
                    description: Quem pode fazer chamadas. Valores - all, known
              examples:
                success:
                  summary: Configurações atualizadas após alteração
                  value:
                    groupadd: contacts
                    last: contacts
                    status: contacts
                    profile: contacts
                    readreceipts: all
                    online: all
                    calladd: all
        '400':
          description: Dados de entrada inválidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
              examples:
                no_valid_settings:
                  summary: Nenhuma configuração válida encontrada
                  value:
                    error: 'No valid privacy settings found. Use format: {"groupadd": "contacts", "last": "none"}'
                invalid_value_type:
                  summary: Valor deve ser string
                  value:
                    error: Value for groupadd must be a non-empty string
                invalid_privacy_type:
                  summary: Tipo de privacidade inválido
                  value:
                    error: >-
                      invalid privacy type: invalidtype. Valid types: groupadd, last, status, profile, readreceipts,
                      online, calladd
                invalid_privacy_value:
                  summary: Valor de privacidade inválido
                  value:
                    error: >-
                      invalid privacy value: invalidvalue. Valid values: all, contacts, contact_blacklist, none,
                      match_last_seen, known
        '401':
          description: Token de autenticação inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: client not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
              examples:
                no_session:
                  summary: Sem sessão ativa
                  value:
                    error: No session
                whatsapp_error:
                  summary: Erro do WhatsApp
                  value:
                    error: 'Failed to set privacy setting: context deadline exceeded'
  /instance/presence:
    post:
      tags:
        - Instancia
      summary: Atualizar status de presença da instância
      description: >
        Atualiza o status de presença global da instância do WhatsApp. Este endpoint permite:

        1. Definir se a instância está disponível (Aparece "online") ou indisponível

        2. Controlar o status de presença para todos os contatos

        3. Salvar o estado atual da presença na instância


        Tipos de presença suportados:

        - available: Marca a instância como disponível/online

        - unavailable: Marca a instância como indisponível/offline


        **Atenção**:

        - O status de presença pode ser temporariamente alterado para "available" (online) em algumas situações internas
        da API, e com isso o visto por último também pode ser atualizado.

        - Caso isso for um problema, considere alterar suas configurações de privacidade no WhatsApp para não mostrar o
        visto por último e/ou quem pode ver seu status "online".


        **⚠️ Importante - Limitação do Presence "unavailable"**:

        - **Quando a API é o único dispositivo ativo**: Confirmações de entrega/leitura (ticks cinzas/azuis) não são
        enviadas nem recebidas

        - **Impacto**: Eventos `message_update` com status de entrega podem não ser recebidos

        - **Solução**: Se precisar das confirmações, mantenha WhatsApp Web ou aplicativo móvel ativo ou use presence
        "available" 


        Exemplo de requisição:

        ```json

        {
          "presence": "available"
        }

        ```


        Exemplo de resposta:

        ```json

        {
          "response": "Presence updated successfully"
        }

        ```


        Erros comuns:

        - 401: Token inválido ou expirado

        - 400: Valor de presença inválido

        - 500: Erro ao atualizar presença
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                presence:
                  type: string
                  description: Status de presença da instância
                  enum:
                    - available
                    - unavailable
                  example: available
              required:
                - presence
      responses:
        '200':
          description: Presença atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                    example: Presence updated successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
                    examples:
                      invalid_payload: Invalid payload
                      invalid_presence: Invalid presence value, use available or unavailable
        '401':
          description: Token inválido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro de autenticação
                    example: client not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro interno
                    example: No session
  /send/text:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar mensagem de texto
      description: >
        Envia uma mensagem de texto para um contato ou grupo.


        ## Recursos Específicos


        - **Preview de links** com suporte a personalização automática ou customizada

        - **Formatação básica** do texto

        - **Substituição automática de placeholders** dinâmicos


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`, `track_source`, `track_id`, placeholders
        e envio para grupos.


        ## Preview de Links


        ### Preview Automático

        ```json

        {
          "number": "5511999999999",
          "text": "Confira: https://exemplo.com",
          "linkPreview": true
        }

        ```


        ### Preview Personalizado

        ```json

        {
          "number": "5511999999999",
          "text": "Confira nosso site! https://exemplo.com",
          "linkPreview": true,
          "linkPreviewTitle": "Título Personalizado",
          "linkPreviewDescription": "Uma descrição personalizada do link",
          "linkPreviewImage": "https://exemplo.com/imagem.jpg",
          "linkPreviewLarge": true
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                text:
                  type: string
                  description: Texto da mensagem (aceita placeholders)
                  example: Olá {{name}}! Como posso ajudar?
                linkPreview:
                  type: boolean
                  description: >
                    Ativa/desativa preview de links. Se true, procura automaticamente um link no texto para gerar
                    preview.


                    Comportamento:

                    - Se apenas linkPreview=true: gera preview automático do primeiro link encontrado no texto

                    - Se fornecidos campos personalizados (title, description, image): usa os valores fornecidos

                    - Se campos personalizados parciais: combina com dados automáticos do link como fallback
                  example: true
                linkPreviewTitle:
                  type: string
                  description: Define um título personalizado para o preview do link
                  example: Título Personalizado
                linkPreviewDescription:
                  type: string
                  description: Define uma descrição personalizada para o preview do link
                  example: Descrição personalizada do link
                linkPreviewImage:
                  type: string
                  description: URL ou Base64 da imagem para usar no preview do link
                  example: https://exemplo.com/imagem.jpg
                linkPreviewLarge:
                  type: boolean
                  description: Se true, gera um preview grande com upload da imagem. Se false, gera um preview pequeno sem upload
                  example: true
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: Números para mencionar (separados por vírgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida após envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca últimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerá 'Digitando...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - text
            examples:
              basic:
                summary: Mensagem básica
                description: Exemplo mais simples possível
                value:
                  number: '5511999999999'
                  text: Olá! Como posso ajudar?
              withLinkPreview:
                summary: Com preview automático
                description: Preview automático de link no texto
                value:
                  number: '5511999999999'
                  text: 'Confira: https://exemplo.com'
                  linkPreview: true
              customLinkPreview:
                summary: Preview personalizado
                description: Preview com título, descrição e imagem customizados
                value:
                  number: '5511999999999'
                  text: Confira nosso site! https://exemplo.com
                  linkPreview: true
                  linkPreviewTitle: Título Personalizado
                  linkPreviewDescription: Uma descrição personalizada do link
                  linkPreviewImage: https://exemplo.com/imagem.jpg
                  linkPreviewLarge: true
              withPlaceholders:
                summary: Com placeholders
                description: Texto com variáveis dinâmicas
                value:
                  number: '5511999999999'
                  text: Olá {{name}}! Sua empresa {{company}} está cadastrada.
      responses:
        '200':
          description: Mensagem enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Message sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing number or text
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '429':
          description: Limite de requisições excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send message
  /send/media:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar mídia (imagem, vídeo, áudio ou documento)
      description: >
        Envia diferentes tipos de mídia para um contato ou grupo. Suporta URLs ou arquivos base64.


        ## Tipos de Mídia Suportados

        - **`image`**: Imagens (JPG preferencialmente)

        - **`video`**: Vídeos (apenas MP4)

        - **`document`**: Documentos (PDF, DOCX, XLSX, etc)

        - **`audio`**: Áudio comum (MP3 ou OGG)

        - **`myaudio`**: Mensagem de voz (alternativa ao PTT)

        - **`ptt`**: Mensagem de voz (Push-to-Talk)

        - **`sticker`**: Figurinha/Sticker


        ## Recursos Específicos

        - **Upload por URL ou base64**

        - **Caption/legenda** opcional com suporte a placeholders

        - **Nome personalizado** para documentos (`docName`)

        - **Geração automática de thumbnails**

        - **Compressão otimizada** conforme o tipo


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`, `track_source`, `track_id`, placeholders
        e envio para grupos.


        ## Exemplos Básicos


        ### Imagem Simples

        ```json

        {
          "number": "5511999999999",
          "type": "image",
          "file": "https://exemplo.com/foto.jpg"
        }

        ```


        ### Documento com Nome

        ```json

        {
          "number": "5511999999999",
          "type": "document",
          "file": "https://exemplo.com/contrato.pdf",
          "docName": "Contrato.pdf",
          "text": "Segue o documento solicitado"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                type:
                  type: string
                  description: Tipo de mídia (image, video, document, audio, myaudio, ptt, sticker)
                  enum:
                    - image
                    - video
                    - document
                    - audio
                    - myaudio
                    - ptt
                    - sticker
                  example: image
                file:
                  type: string
                  description: URL ou base64 do arquivo
                  example: https://exemplo.com/imagem.jpg
                text:
                  type: string
                  description: Texto descritivo (caption) - aceita placeholders
                  example: Veja esta foto!
                docName:
                  type: string
                  description: Nome do arquivo (apenas para documents)
                  example: relatorio.pdf
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: Números para mencionar (separados por vírgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida após envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca últimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: >-
                    Atraso em milissegundos antes do envio, durante o atraso apacerá 'Digitando...' ou 'Gravando
                    áudio...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - type
                - file
            examples:
              image:
                summary: Imagem
                description: Envio de imagem simples
                value:
                  number: '5511999999999'
                  type: image
                  file: https://exemplo.com/foto.jpg
              imageWithCaption:
                summary: Imagem com legenda
                description: Imagem com texto descritivo
                value:
                  number: '5511999999999'
                  type: image
                  file: https://exemplo.com/foto.jpg
                  text: Veja esta foto!
              document:
                summary: Documento
                description: Documento PDF com nome personalizado
                value:
                  number: '5511999999999'
                  type: document
                  file: https://exemplo.com/contrato.pdf
                  docName: Contrato.pdf
                  text: Segue o documento solicitado
              audio:
                summary: Mensagem de voz
                description: Arquivo de áudio como mensagem de voz
                value:
                  number: '5511999999999'
                  type: ptt
                  file: https://exemplo.com/audio.ogg
              video:
                summary: Vídeo
                description: Arquivo de vídeo com legenda
                value:
                  number: '5511999999999'
                  type: video
                  file: https://exemplo.com/video.mp4
                  text: Confira este vídeo!
              sticker:
                summary: Figurinha
                description: Envio de figurinha/sticker
                value:
                  number: '5511999999999'
                  type: sticker
                  file: https://exemplo.com/sticker.webp
      responses:
        '200':
          description: Mídia enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Media sent successfully
                          fileUrl:
                            type: string
                            example: https://mmg.whatsapp.net/...
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid media type or file format
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '413':
          description: Arquivo muito grande
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: File size exceeds limit
        '415':
          description: Formato de mídia não suportado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unsupported media format
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to upload media
  /send/contact:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar cartão de contato (vCard)
      description: >
        Envia um cartão de contato (vCard) para um contato ou grupo.


        ## Recursos Específicos


        - **vCard completo** com nome, telefones, organização, email e URL

        - **Múltiplos números de telefone** (separados por vírgula)

        - **Cartão clicável** no WhatsApp para salvar na agenda

        - **Informações profissionais** (organização/empresa)


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`, `track_source`, `track_id`, placeholders
        e envio para grupos.


        ## Exemplo Básico

        ```json

        {
          "number": "5511999999999",
          "fullName": "João Silva",
          "phoneNumber": "5511999999999,5511888888888",
          "organization": "Empresa XYZ",
          "email": "joao.silva@empresa.com",
          "url": "https://empresa.com/joao"
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                fullName:
                  type: string
                  description: Nome completo do contato
                  example: João Silva
                phoneNumber:
                  type: string
                  description: Números de telefone (separados por vírgula)
                  example: 5511999999999,5511888888888
                organization:
                  type: string
                  description: Nome da organização/empresa
                  example: Empresa XYZ
                email:
                  type: string
                  description: Endereço de email
                  example: joao@empresa.com
                url:
                  type: string
                  description: URL pessoal ou da empresa
                  example: https://empresa.com/joao
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: Números para mencionar (separados por vírgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida após envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca últimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerá 'Digitando...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - fullName
                - phoneNumber
      responses:
        '200':
          description: Cartão de contato enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Contact card sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '429':
          description: Limite de requisições excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send contact card
  /send/location:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar localização geográfica
      description: >
        Envia uma localização geográfica para um contato ou grupo.


        ## Recursos Específicos


        - **Coordenadas precisas** (latitude e longitude obrigatórias)

        - **Nome do local** para identificação

        - **Mapa interativo** no WhatsApp para navegação

        - **Pin personalizado** com nome do local


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`, `track_source`, `track_id`, placeholders
        e envio para grupos.


        ## Exemplo Básico

        ```json

        {
          "number": "5511999999999",
          "name": "Maracanã",
          "address": "Av. Pres. Castelo Branco, Portão 3 - Maracanã, Rio de Janeiro - RJ, 20271-130",
          "latitude": -22.912982815767986,
          "longitude": -43.23028153499254
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                name:
                  type: string
                  description: Nome do local
                  example: MASP
                address:
                  type: string
                  description: Endereço completo do local
                  example: Av. Paulista, 1578 - Bela Vista
                latitude:
                  type: number
                  description: Latitude (-90 a 90)
                  example: -23.5616
                longitude:
                  type: number
                  description: Longitude (-180 a 180)
                  example: -46.6562
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: Números para mencionar (separados por vírgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida após envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca últimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerá 'Digitando...'
                  example: 1000
                forward:
                  type: boolean
                  description: Marca a mensagem como encaminhada no WhatsApp
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - latitude
                - longitude
      responses:
        '200':
          description: Localização enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Location sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid coordinates or missing number
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '429':
          description: Limite de requisições excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send location
  /message/presence:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar atualização de presença
      description: |
        Envia uma atualização de presença para um contato ou grupo de forma **assíncrona**.

        ## 🔄 Comportamento Assíncrono:
        - **Execução independente**: A presença é gerenciada em background, não bloqueia o retorno da API
        - **Limite máximo**: 5 minutos de duração (300 segundos)
        - **Tick de atualização**: Reenvia a presença a cada 10 segundos
        - **Cancelamento automático**: Presença é cancelada automaticamente ao enviar uma mensagem para o mesmo chat

        ## 📱 Tipos de presença suportados:
        - **composing**: Indica que você está digitando uma mensagem
        - **recording**: Indica que você está gravando um áudio
        - **paused**: Remove/cancela a indicação de presença atual

        ## ⏱️ Controle de duração:
        - **Sem delay**: Usa limite padrão de 5 minutos
        - **Com delay**: Usa o valor especificado (máximo 5 minutos)
        - **Cancelamento**: Envio de mensagem cancela presença automaticamente

        ## 📋 Exemplos de uso:

        ### Digitar por 30 segundos:
        ```json
        {
          "number": "5511999999999",
          "presence": "composing",
          "delay": 30000
        }
        ```

        ### Gravar áudio por 1 minuto:
        ```json
        {
          "number": "5511999999999",
          "presence": "recording",
          "delay": 60000
        }
        ```

        ### Cancelar presença atual:
        ```json
        {
          "number": "5511999999999",
          "presence": "paused"
        }
        ```

        ### Usar limite máximo (5 minutos):
        ```json
        {
          "number": "5511999999999",
          "presence": "composing"
        }
        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: 'Número do destinatário no formato internacional (ex: 5511999999999)'
                  example: '5511999999999'
                presence:
                  type: string
                  description: Tipo de presença a ser enviada
                  enum:
                    - composing
                    - recording
                    - paused
                  example: composing
                delay:
                  type: integer
                  description: |
                    Duração em milissegundos que a presença ficará ativa (máximo 5 minutos = 300000ms).
                    Se não informado ou valor maior que 5 minutos, usa o limite padrão de 5 minutos.
                    A presença é reenviada a cada 10 segundos durante este período.
                  maximum: 300000
                  example: 30000
              required:
                - number
                - presence
      responses:
        '200':
          description: Presença atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                    example: Chat presence sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
                    example: Número inválido ou tipo de presença inválido
        '401':
          description: Token inválido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro de autenticação
                    example: Token inválido ou expirado
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro interno
                    example: Erro ao enviar presença
  /send/status:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar Stories (Status)
      description: >
        Envia um story (status) com suporte para texto, imagem, vídeo e áudio.


        **Suporte a campos de rastreamento**: Este endpoint também suporta `track_source` e `track_id` documentados na
        tag **"Enviar Mensagem"**.


        ## Tipos de Status

        - text: Texto com estilo e cor de fundo

        - image: Imagens com legenda opcional

        - video: Vídeos com thumbnail e legenda

        - audio: Áudio normal ou mensagem de voz (PTT)


        ## Cores de Fundo

        - 1-3: Tons de amarelo

        - 4-6: Tons de verde

        - 7-9: Tons de azul

        - 10-12: Tons de lilás

        - 13: Magenta

        - 14-15: Tons de rosa

        - 16: Marrom claro

        - 17-19: Tons de cinza (19 é o padrão)


        ## Fontes (para texto)

        - 0: Padrão 

        - 1-8: Estilos alternativos


        ## Limites

        - Texto: Máximo 656 caracteres

        - Imagem: JPG, PNG, GIF

        - Vídeo: MP4, MOV

        - Áudio: MP3, OGG, WAV (convertido para OGG/OPUS)


        ## Exemplo

        ```json

        {
          "type": "text",
          "text": "Novidades chegando!",
          "background_color": 7,
          "font": 1
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum:
                    - text
                    - image
                    - video
                    - audio
                    - myaudio
                    - ptt
                  description: Tipo do status
                  example: text
                text:
                  type: string
                  description: Texto principal ou legenda
                  example: Novidades chegando!
                background_color:
                  type: integer
                  minimum: 1
                  maximum: 19
                  description: Código da cor de fundo
                  example: 7
                font:
                  type: integer
                  minimum: 0
                  maximum: 8
                  description: Estilo da fonte (apenas para type=text)
                  example: 1
                file:
                  type: string
                  description: URL ou Base64 do arquivo de mídia
                  example: https://example.com/video.mp4
                thumbnail:
                  type: string
                  description: URL ou Base64 da miniatura (opcional para vídeos)
                  example: https://example.com/thumb.jpg
                mimetype:
                  type: string
                  description: MIME type do arquivo (opcional)
                  example: video/mp4
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - type
      responses:
        '200':
          description: Status enviado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  Id:
                    type: string
                    example: ABCD1234
                  content:
                    type: object
                    description: Conteúdo processado da mensagem
                  messageTimestamp:
                    type: integer
                    example: 1672531200000
                  status:
                    type: string
                    example: Pending
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Text too long
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to upload media
  /send/menu:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar menu interativo (botões, carrosel, lista ou enquete)
      description: >
        Este endpoint oferece uma interface unificada para envio de quatro tipos principais de mensagens interativas:

        - Botões: Para ações rápidas e diretas

        - Carrosel de Botões: Para uma lista horizontal de botões com imagens

        - Listas: Para menus organizados em seções

        - Enquetes: Para coleta de opiniões e votações


        **Suporte a campos de rastreamento**: Este endpoint também suporta `track_source` e `track_id` documentados na
        tag **"Enviar Mensagem"**.


        ## Estrutura Base do Payload


        Todas as requisições seguem esta estrutura base:


        ```json

        {
          "number": "5511999999999",
          "type": "button|list|poll|carousel",
          "text": "Texto principal da mensagem",
          "choices": ["opções baseadas no tipo escolhido"],
          "footerText": "Texto do rodapé (opcional para botões e listas)",
          "listButton": "Texto do botão (para listas)",
          "selectableCount": "Número de opções selecionáveis (apenas para enquetes)"
        }

        ```


        ## Tipos de Mensagens Interativas


        ### 1. Botões (type: "button")


        Cria botões interativos com diferentes funcionalidades de ação.


        #### Campos Específicos

        - `footerText`: Texto opcional exibido abaixo da mensagem principal

        - `choices`: Array de opções que serão convertidas em botões


        #### Formatos de Botões

        Cada botão pode ser configurado usando `|` (pipe) ou `\n` (quebra de linha) como separadores:


        - **Botão de Resposta**: 
          - `"texto|id"` ou 
          - `"texto\nid"` ou 
          - `"texto"` (ID será igual ao texto)

        - **Botão de Cópia**: 
          - `"texto|copy:código"` ou 
          - `"texto\ncopy:código"`

        - **Botão de Chamada**: 
          - `"texto|call:+5511999999999"` ou 
          - `"texto\ncall:+5511999999999"`

        - **Botão de URL**: 
          - `"texto|https://exemplo.com"` ou 
          - `"texto|url:https://exemplo.com"`

        #### Botões com Imagem

        Para adicionar uma imagem aos botões, use o campo `imageButton` no payload:


        #### Exemplo com Imagem

        ```json

        {
          "number": "5511999999999",
          "type": "button",
          "text": "Escolha um produto:",
          "imageButton": "https://exemplo.com/produto1.jpg",
          "choices": [
            "Produto A|prod_a",
            "Mais Info|https://exemplo.com/produto-a",
            "Produto B|prod_b",
            "Ligar|call:+5511999999999"
          ],
          "footerText": "Produtos em destaque"
        }

        ```


        > **Suporte**: O campo `imageButton` aceita URLs ou imagens em base64.


        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "button",
          "text": "Como podemos ajudar?",
          "choices": [
            "Suporte Técnico|suporte",
            "Fazer Pedido|pedido",
            "Nosso Site|https://exemplo.com",
            "Falar Conosco|call:+5511999999999"
          ],
          "footerText": "Escolha uma das opções abaixo"
        }

        ```


        #### Limitações e Compatibilidade

        > **Importante**: Ao combinar botões de resposta com outros tipos (call, url, copy) na mesma mensagem, será
        exibido o aviso: "Não é possível exibir esta mensagem no WhatsApp Web. Abra o WhatsApp no seu celular para
        visualizá-la."


        ### 2. Listas (type: "list")


        Cria menus organizados em seções com itens selecionáveis.


        #### Campos Específicos

        - `listButton`: Texto do botão que abre a lista

        - `footerText`: Texto opcional do rodapé

        - `choices`: Array com seções e itens da lista


        #### Formato das Choices

        - `"[Título da Seção]"`: Inicia uma nova seção

        - `"texto|id|descrição"`: Item da lista com:
          - texto: Label do item
          - id: Identificador único, opcional
          - descrição: Texto descritivo adicional e opcional

        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "list",
          "text": "Catálogo de Produtos",
          "choices": [
            "[Eletrônicos]",
            "Smartphones|phones|Últimos lançamentos",
            "Notebooks|notes|Modelos 2024",
            "[Acessórios]",
            "Fones|fones|Bluetooth e com fio",
            "Capas|cases|Proteção para seu device"
          ],
          "listButton": "Ver Catálogo",
          "footerText": "Preços sujeitos a alteração"
        }

        ```


        ### 3. Enquetes (type: "poll")


        Cria enquetes interativas para votação.


        #### Campos Específicos

        - `selectableCount`: Número de opções que podem ser selecionadas (padrão: 1)

        - `choices`: Array simples com as opções de voto


        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "poll",
          "text": "Qual horário prefere para atendimento?",
          "choices": [
            "Manhã (8h-12h)",
            "Tarde (13h-17h)",
            "Noite (18h-22h)"
          ],
          "selectableCount": 1
        }

        ```


        ### 4. Carousel (type: "carousel")


        Cria um carrossel de cartões com imagens e botões interativos.


        #### Campos Específicos

        - `choices`: Array com elementos do carrossel na seguinte ordem:
          - `[Texto do cartão]`: Texto do cartão entre colchetes
          - `{URL ou base64 da imagem}`: Imagem entre chaves
          - Botões do cartão (um por linha):
            - `"texto|copy:código"` para botão de copiar
            - `"texto|https://url"` para botão de link
            - `"texto|call:+número"` para botão de ligação

        #### Exemplo Completo

        ```json

        {
          "number": "5511999999999",
          "type": "carousel",
          "text": "Conheça nossos produtos",
          "choices": [
            "[Smartphone XYZ\nO mais avançado smartphone da linha]",
            "{https://exemplo.com/produto1.jpg}",
            "Copiar Código|copy:PROD123",
            "Ver no Site|https://exemplo.com/xyz",
            "Fale Conosco|call:+5511999999999",
            "[Notebook ABC\nO notebook ideal para profissionais]",
            "{https://exemplo.com/produto2.jpg}",
            "Copiar Código|copy:NOTE456",
            "Comprar Online|https://exemplo.com/abc",
            "Suporte|call:+5511988888888"
          ]
        }

        ```


        > **Nota**: Criamos outro endpoint para carrossel: `/send/carousel`, funciona da mesma forma, mas com outro
        formato de payload. Veja o que é mais fácil para você.


        ## Termos de uso


        Os recursos de botões interativos e listas podem ser descontinuados a qualquer momento sem aviso prévio. Não nos
        responsabilizamos por quaisquer alterações ou indisponibilidade destes recursos.


        ### Alternativas e Compatibilidade


        Considerando a natureza dinâmica destes recursos, nosso endpoint foi projetado para facilitar a migração entre
        diferentes tipos de mensagens (botões, listas e enquetes). 


        Recomendamos criar seus fluxos de forma flexível, preparados para alternar entre os diferentes tipos.


        Em caso de descontinuidade de algum recurso, você poderá facilmente migrar para outro tipo de mensagem apenas
        alterando o campo "type" no payload, mantendo a mesma estrutura de choices.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                type:
                  type: string
                  description: Tipo do menu (button, list, poll, carousel)
                  enum:
                    - button
                    - list
                    - poll
                    - carousel
                  example: list
                text:
                  type: string
                  description: Texto principal (aceita placeholders)
                  example: 'Escolha uma opção:'
                footerText:
                  type: string
                  description: Texto do rodapé (opcional)
                  example: Menu de serviços
                listButton:
                  type: string
                  description: Texto do botão principal
                  example: Ver opções
                selectableCount:
                  type: integer
                  description: Número máximo de opções selecionáveis (para enquetes)
                  example: 1
                choices:
                  type: array
                  description: Lista de opções. Use [Título] para seções em listas
                  items:
                    type: string
                  example:
                    - '[Eletrônicos]'
                    - Smartphones|phones|Últimos lançamentos
                    - Notebooks|notes|Modelos 2024
                    - '[Acessórios]'
                    - Fones|fones|Bluetooth e com fio
                    - Capas|cases|Proteção para seu device
                imageButton:
                  type: string
                  description: 'URL da imagem para botões (recomendado para type: button)'
                  example: https://exemplo.com/imagem-botao.jpg
                replyid:
                  type: string
                  description: ID da mensagem para responder
                  example: 3EB0538DA65A59F6D8A251
                mentions:
                  type: string
                  description: Números para mencionar (separados por vírgula)
                  example: 5511999999999,5511888888888
                readchat:
                  type: boolean
                  description: Marca conversa como lida após envio
                  example: true
                readmessages:
                  type: boolean
                  description: Marca últimas mensagens recebidas como lidas
                  example: true
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio, durante o atraso apacerá 'Digitando...'
                  example: 1000
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - type
                - text
                - choices
      responses:
        '200':
          description: Menu enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Menu sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields or invalid menu type
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '429':
          description: Limite de requisições excedido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Rate limit exceeded
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send menu
  /send/carousel:
    post:
      tags:
        - Enviar Mensagem
      summary: Enviar carrossel de mídia com botões
      description: >
        Este endpoint permite enviar um carrossel com imagens e botões interativos.

        Funciona de maneira igual ao endpoint `/send/menu` com type: carousel, porém usando outro formato de payload.


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`, `track_source`, `track_id`, placeholders
        e envio para grupos.


        ## Estrutura do Payload


        ```json

        {
          "number": "5511999999999",
          "text": "Texto principal",
          "carousel": [
            {
              "text": "Texto do cartão",
              "image": "URL da imagem",
              "buttons": [
                {
                  "id": "resposta1",
                  "text": "Texto do botão",
                  "type": "REPLY"
                }
              ]
            }
          ],
          "delay": 1000,
          "readchat": true
        }

        ```


        ## Tipos de Botões


        - `REPLY`: Botão de resposta rápida
          - Quando clicado, envia o valor do id como resposta ao chat
          - O id será o texto enviado como resposta

        - `URL`: Botão com link
          - Quando clicado, abre a URL especificada
          - O id deve conter a URL completa (ex: https://exemplo.com)

        - `COPY`: Botão para copiar texto
          - Quando clicado, copia o texto para a área de transferência
          - O id será o texto que será copiado

        - `CALL`: Botão para realizar chamada
          - Quando clicado, inicia uma chamada telefônica
          - O id deve conter o número de telefone

        ## Exemplo de Botões

        ```json

        {
          "buttons": [
            {
              "id": "Sim, quero comprar!",
              "text": "Confirmar Compra",
              "type": "REPLY"
            },
            {
              "id": "https://exemplo.com/produto",
              "text": "Ver Produto",
              "type": "URL"
            },
            {
              "id": "CUPOM20",
              "text": "Copiar Cupom",
              "type": "COPY"
            },
            {
              "id": "5511999999999",
              "text": "Falar com Vendedor",
              "type": "CALL"
            }
          ]
        }

        ```


        ## Exemplo Completo de Carrossel

        ```json

        {
          "number": "5511999999999",
          "text": "Nossos Produtos em Destaque",
          "carousel": [
            {
              "text": "Smartphone XYZ\nO mais avançado smartphone da linha",
              "image": "https://exemplo.com/produto1.jpg",
              "buttons": [
                {
                  "id": "SIM_COMPRAR_XYZ",
                  "text": "Comprar Agora",
                  "type": "REPLY"
                },
                {
                  "id": "https://exemplo.com/xyz",
                  "text": "Ver Detalhes",
                  "type": "URL"
                }
              ]
            },
            {
              "text": "Cupom de Desconto\nGanhe 20% OFF em qualquer produto",
              "image": "https://exemplo.com/cupom.jpg",
              "buttons": [
                {
                  "id": "DESCONTO20",
                  "text": "Copiar Cupom",
                  "type": "COPY"
                },
                {
                  "id": "5511999999999",
                  "text": "Falar com Vendedor",
                  "type": "CALL"
                }
              ]
            }
          ],
          "delay": 0,
          "readchat": true
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                text:
                  type: string
                  description: Texto principal da mensagem
                  example: Nossos Produtos em Destaque
                carousel:
                  type: array
                  description: Array de cartões do carrossel
                  items:
                    type: object
                    properties:
                      text:
                        type: string
                        description: Texto do cartão
                        example: |-
                          Smartphone XYZ
                          O mais avançado smartphone da linha
                      image:
                        type: string
                        description: URL da imagem (opcional)
                        example: https://exemplo.com/produto1.jpg
                      buttons:
                        type: array
                        description: Array de botões do cartão
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              description: ID do botão
                              example: buy_xyz
                            text:
                              type: string
                              description: Texto exibido no botão
                              example: Comprar Agora
                            type:
                              type: string
                              description: |
                                Tipo do botão:
                                * REPLY - O id será enviado como resposta ao chat
                                * URL - O id deve ser a URL completa que será aberta
                                * COPY - O id será o texto copiado para área de transferência
                                * CALL - O id deve ser o número de telefone para a chamada
                              enum:
                                - REPLY
                                - URL
                                - CALL
                                - COPY
                              example: REPLY
                    required:
                      - text
                      - buttons
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - text
                - carousel
      responses:
        '200':
          description: Carrossel enviado com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Carousel sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields or invalid card format
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send carousel
  /send/location-button:
    post:
      tags:
        - Enviar Mensagem
      summary: Solicitar localização do usuário
      description: >
        Este endpoint envia uma mensagem com um botão que solicita a localização do usuário.

        Quando o usuário clica no botão, o WhatsApp abre a interface para compartilhar a localização atual.


        ## Campos Comuns


        Este endpoint suporta todos os **campos opcionais comuns** documentados na tag **"Enviar Mensagem"**, incluindo:

        `delay`, `readchat`, `readmessages`, `replyid`, `mentions`, `forward`, `track_source`, `track_id`, placeholders
        e envio para grupos.


        ## Estrutura do Payload


        ```json

        {
          "number": "5511999999999",
          "text": "Por favor, compartilhe sua localização",
          "delay": 0,
          "readchat": true
        }

        ```


        ## Exemplo de Uso


        ```json

        {
          "number": "5511999999999",
          "text": "Para continuar o atendimento, clique no botão abaixo e compartilhe sua localização"
        }

        ```


        > **Nota**: O botão de localização é adicionado automaticamente à mensagem
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do destinatário (formato internacional)
                  example: '5511999999999'
                text:
                  type: string
                  description: Texto da mensagem que será exibida
                  example: Por favor, compartilhe sua localização
                delay:
                  type: integer
                  description: Atraso em milissegundos antes do envio
                  example: 0
                readchat:
                  type: boolean
                  description: Se deve marcar a conversa como lida após envio
                  example: true
                track_source:
                  type: string
                  description: Origem do rastreamento da mensagem
                  example: chatwoot
                track_id:
                  type: string
                  description: ID para rastreamento da mensagem (aceita valores duplicados)
                  example: msg_123456789
              required:
                - number
                - text
      responses:
        '200':
          description: Localização enviada com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/message.yaml#/Message
                  - type: object
                    properties:
                      response:
                        type: object
                        properties:
                          status:
                            type: string
                            example: success
                          message:
                            type: string
                            example: Location sent successfully
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields or invalid coordinates
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to send location
  /message/download:
    post:
      tags:
        - Ações na mensagem e Buscar
      summary: Baixar arquivo de uma mensagem
      description: >
        Baixa o arquivo associado a uma mensagem de mídia (imagem, vídeo, áudio, documento ou sticker).


        ## Parâmetros


        - **id** (string, obrigatório): ID da mensagem

        - **return_base64** (boolean, default: false): Retorna arquivo em base64

        - **generate_mp3** (boolean, default: true): Para áudios, define formato de retorno
          - `true`: Retorna MP3
          - `false`: Retorna OGG
        - **return_link** (boolean, default: true): Retorna URL pública do arquivo

        - **transcribe** (boolean, default: false): Transcreve áudios para texto

        - **openai_apikey** (string, opcional): Chave OpenAI para transcrição
          - Se não informada, usa a chave salva na instância
          - Se informada, atualiza e salva na instância para próximas chamadas
        - **download_quoted** (boolean, default: false): Baixa mídia da mensagem citada
          - Útil para baixar conteúdo original de status do WhatsApp
          - Quando uma mensagem é resposta a um status, permite baixar a mídia do status original
          - **Contextualização**: Ao baixar a mídia citada, você identifica o contexto da conversa
            - Exemplo: Se alguém responde a uma promoção, baixando a mídia você saberá que a pergunta é sobre aquela promoção específica

        ## Exemplos


        ### Baixar áudio como MP3:

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "generate_mp3": true
        }

        ```


        ### Transcrever áudio:

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "transcribe": true
        }

        ```


        ### Apenas base64 (sem salvar):

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "return_base64": true,
          "return_link": false
        }

        ```


        ### Baixar mídia de status (mensagem citada):

        ```json

        {
          "id": "7EB0F01D7244B421048F0706368376E0",
          "download_quoted": true
        }

        ```

        *Útil quando o cliente responde a uma promoção/status - você baixa a mídia original para entender sobre qual
        produto/oferta ele está perguntando.*


        ## Resposta


        ```json

        {
          "fileURL": "https://api.exemplo.com/files/arquivo.mp3",
          "mimetype": "audio/mpeg",
          "base64Data": "UklGRkj...",
          "transcription": "Texto transcrito"
        }

        ```


        **Nota**: 

        - Por padrão, se não definido o contrário:
          1. áudios são retornados como MP3. 
          2. E todos os pedidos de download são retornados com URL pública.
        - Transcrição requer chave OpenAI válida. A chave pode ser configurada uma vez na instância e será reutilizada
        automaticamente.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID da mensagem contendo o arquivo
                  example: 7EB0F01D7244B421048F0706368376E0
                return_base64:
                  type: boolean
                  description: Se verdadeiro, retorna o conteúdo em base64
                  default: false
                generate_mp3:
                  type: boolean
                  description: Para áudios, define formato de retorno (true=MP3, false=OGG)
                  default: true
                return_link:
                  type: boolean
                  description: Salva e retorna URL pública do arquivo
                  default: true
                transcribe:
                  type: boolean
                  description: Se verdadeiro, transcreve áudios para texto
                  default: false
                openai_apikey:
                  type: string
                  description: Chave da API OpenAI para transcrição (opcional)
                  example: sk-...
                download_quoted:
                  type: boolean
                  description: Se verdadeiro, baixa mídia da mensagem citada ao invés da mensagem principal
                  default: false
              required:
                - id
      responses:
        '200':
          description: Successful file download
          content:
            application/json:
              schema:
                type: object
                properties:
                  fileURL:
                    type: string
                    description: URL pública para acessar o arquivo (se return_link=true)
                    example: https://api.exemplo.com/files/arquivo.mp3
                  mimetype:
                    type: string
                    description: Tipo MIME do arquivo
                    example: audio/mpeg
                  base64Data:
                    type: string
                    description: Conteúdo do arquivo em base64 (se return_base64=true)
                    example: UklGRkj...
                  transcription:
                    type: string
                    description: Texto transcrito do áudio (se transcribe=true)
                    example: Texto transcrito
                required:
                  - mimetype
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unsupported media type or no media found in message
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid token
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Message not found
                examples:
                  message_not_found:
                    summary: Mensagem não encontrada
                    value:
                      error: Message not found
                  no_quoted_message:
                    summary: Mensagem citada não encontrada (quando download_quoted=true)
                    value:
                      error: No quoted message found in this message
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to download media
  /message/find:
    post:
      tags:
        - Ações na mensagem e Buscar
      summary: Buscar mensagens em um chat
      description: |
        Busca mensagens com múltiplos filtros disponíveis. Este endpoint permite:

        1. **Busca por ID específico**: Use `id` para encontrar uma mensagem exata
        2. **Filtrar por chat**: Use `chatid` para mensagens de uma conversa específica
        3. **Filtrar por rastreamento**: Use `track_source` e `track_id` para mensagens com dados de tracking
        4. **Limitar resultados**: Use `limit` para controlar quantas mensagens retornar
        5. **Ordenação**: Resultados ordenados por data (mais recentes primeiro)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID específico da mensagem para busca exata
                  example: user123:r3EB0538
                chatid:
                  type: string
                  description: ID do chat no formato internacional
                  example: 5511999999999@s.whatsapp.net
                track_source:
                  type: string
                  description: Origem do rastreamento para filtrar mensagens
                  example: chatwoot
                track_id:
                  type: string
                  description: ID de rastreamento para filtrar mensagens
                  example: msg_123456789
                limit:
                  type: integer
                  description: Número máximo de mensagens a retornar
                  minimum: 1
                  default: 100
                  example: 10
            examples:
              chatSearch:
                summary: Buscar por chat específico
                description: Busca mensagens de uma conversa específica
                value:
                  chatid: 5511999999999@s.whatsapp.net
                  limit: 10
              idSearch:
                summary: Buscar por ID específico
                description: Busca uma mensagem específica pelo seu ID
                value:
                  id: user123:r3EB0538
              trackingSearch:
                summary: Buscar por rastreamento
                description: Busca mensagens usando dados de tracking
                value:
                  track_source: chatwoot
                  track_id: conv_123456
                  limit: 50
      responses:
        '200':
          description: Lista de mensagens encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: ../schemas/message.yaml#/Message
        '400':
          description: Parâmetros inválidos
        '401':
          description: Token inválido ou expirado
        '404':
          description: Chat não encontrado
        '500':
          description: Erro interno do servidor
  /message/markread:
    post:
      tags:
        - Ações na mensagem e Buscar
      summary: Marcar mensagens como lidas
      description: |
        Marca uma ou mais mensagens como lidas. Este endpoint permite:
        1. Marcar múltiplas mensagens como lidas de uma vez
        2. Atualizar o status de leitura no WhatsApp
        3. Sincronizar o status de leitura entre dispositivos

        Exemplo de requisição básica:
        ```json
        {
          "id": [
            "62AD1AD844E518180227BF68DA7ED710",
            "ECB9DE48EB41F77BFA8491BFA8D6EF9B"  
          ]
        }
        ```

        Exemplo de resposta:
        ```json
        {
          "success": true,
          "message": "Messages marked as read",
          "markedMessages": [
            {
              "id": "62AD1AD844E518180227BF68DA7ED710",
              "timestamp": 1672531200000
            },
            {
              "id": "ECB9DE48EB41F77BFA8491BFA8D6EF9B",
              "timestamp": 1672531300000
            }
          ]
        }
        ```

        Parâmetros disponíveis:
        - id: Lista de IDs das mensagens a serem marcadas como lidas

        Erros comuns:
        - 401: Token inválido ou expirado
        - 400: Lista de IDs vazia ou inválida
        - 404: Uma ou mais mensagens não encontradas
        - 500: Erro ao marcar mensagens como lidas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: array
                  description: Lista de IDs das mensagens a serem marcadas como lidas
                  items:
                    type: string
                  example:
                    - 62AD1AD844E518180227BF68DA7ED710
                    - ECB9DE48EB41F77BFA8491BFA8D6EF9B
              required:
                - id
      responses:
        '200':
          description: Messages successfully marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        message_id:
                          type: string
                          description: ID of the message that was processed
                        status:
                          type: string
                          enum:
                            - success
                            - error
                          description: Status of the mark as read operation
                        error:
                          type: string
                          description: Error message if status is error
                    example:
                      - message_id: 62AD1AD844E518180227BF68DA7ED710
                        status: success
                      - message_id: ECB9DE48EB41F77BFA8491BFA8D6EF9B
                        status: error
                        error: Message not found
        '400':
          description: Invalid request payload or missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing Id in Payload
        '401':
          description: Unauthorized - invalid or missing token
        '500':
          description: Server error while processing the request
  /message/react:
    post:
      tags:
        - Ações na mensagem e Buscar
      summary: Enviar reação a uma mensagem
      description: |
        Envia uma reação (emoji) a uma mensagem específica. Este endpoint permite:

        1. Adicionar ou remover reações em mensagens

        2. Usar qualquer emoji Unicode válido

        3. Reagir a mensagens em chats individuais ou grupos

        4. Remover reações existentes

        5. Verificar o status da reação enviada


        Tipos de reações suportados:

        - Qualquer emoji Unicode válido (👍, ❤️, 😂, etc)

        - String vazia para remover reação


        Exemplo de requisição básica:

        ```json

        {
          "number": "5511999999999@s.whatsapp.net",
          "text": "👍",
          "id": "3EB0538DA65A59F6D8A251"
        }

        ```


        Exemplo de requisição para remover reação:

        ```json

        {
          "number": "5511999999999@s.whatsapp.net",
          "text": "",
          "id": "3EB0538DA65A59F6D8A251"
        }

        ```


        Exemplo de resposta:

        ```json

        {
          "success": true,
          "message": "Reaction sent",
          "reaction": {
            "id": "3EB0538DA65A59F6D8A251",
            "emoji": "👍",
            "timestamp": 1672531200000,
            "status": "sent"
          }
        }

        ```


        Exemplo de resposta ao remover reação:

        ```json

        {
          "success": true,
          "message": "Reaction removed",
          "reaction": {
            "id": "3EB0538DA65A59F6D8A251",
            "emoji": null,
            "timestamp": 1672531200000,
            "status": "removed"
          }
        }

        ```


        Parâmetros disponíveis:

        - number: Número do chat no formato internacional (ex:
        5511999999999@s.whatsapp.net)

        - text: Emoji Unicode da reação (ou string vazia para remover reação)

        - id: ID da mensagem que receberá a reação


        Erros comuns:

        - 401: Token inválido ou expirado

        - 400: Número inválido ou emoji não suportado

        - 404: Mensagem não encontrada

        - 500: Erro ao enviar reação


        Limitações:

        - Só é possível reagir a mensagens enviadas por outros usuários

        - Não é possível reagir a mensagens antigas (mais de 7 dias)

        - O mesmo usuário só pode ter uma reação ativa por mensagem
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do chat no formato internacional
                  example: 5511999999999@s.whatsapp.net
                text:
                  type: string
                  description: Emoji Unicode da reação (ou string vazia para remover reação)
                  example: 👍
                id:
                  type: string
                  description: ID da mensagem que receberá a reação
                  example: 3EB0538DA65A59F6D8A251
              required:
                - number
                - text
                - id
      responses:
        '200':
          description: Reação enviada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: ID único da mensagem de reação
                    example: owner:generated_message_id
                  messageid:
                    type: string
                    description: ID gerado para a mensagem de reação
                    example: generated_message_id
                  content:
                    type: object
                    description: Detalhes da reação
                  messageTimestamp:
                    type: number
                    description: Timestamp da mensagem em milissegundos
                    example: 1672531200000
                  messageType:
                    type: string
                    description: Tipo da mensagem
                    example: reaction
                  status:
                    type: string
                    description: Status atual da mensagem
                    example: Pending
                  owner:
                    type: string
                    description: Proprietário da instância
                    example: instance_owner
        '400':
          description: Erro nos dados da requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing Id in Payload
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '404':
          description: Mensagem não encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Message not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error sending message
  /message/delete:
    post:
      tags:
        - Ações na mensagem e Buscar
      summary: Apagar Mensagem Para Todos
      description: |
        Apaga uma mensagem para todos os participantes da conversa.

        ### Funcionalidades:
        - Apaga mensagens em conversas individuais ou grupos
        - Funciona com mensagens enviadas pelo usuário ou recebidas
        - Atualiza o status no banco de dados
        - Envia webhook de atualização

        **Notas Técnicas**:
        1. O ID da mensagem pode ser fornecido em dois formatos:
           - ID completo (contém ":"): usado diretamente
           - ID curto: concatenado com o owner para busca
        2. Gera evento webhook do tipo "messages_update"
        3. Atualiza o status da mensagem para "Deleted"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID da mensagem a ser apagada
              required:
                - id
      responses:
        '200':
          description: Mensagem apagada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  timestamp:
                    type: string
                    format: date-time
                  id:
                    type: string
        '400':
          description: Payload inválido ou ID de chat/sender inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        '401':
          description: Token não fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '404':
          description: Mensagem não encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: message not found
        '500':
          description: Erro interno do servidor ou sessão não iniciada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
  /message/edit:
    post:
      tags:
        - Ações na mensagem e Buscar
      summary: Edita uma mensagem enviada
      description: |
        Edita o conteúdo de uma mensagem já enviada usando a funcionalidade nativa do WhatsApp.

        O endpoint realiza:
        - Busca a mensagem original no banco de dados usando o ID fornecido
        - Edita o conteúdo da mensagem para o novo texto no WhatsApp
        - Gera um novo ID para a mensagem editada
        - Retorna objeto de mensagem completo seguindo o padrão da API
        - Dispara eventos SSE/Webhook automaticamente

        **Importante**: 
        - Só é possível editar mensagens enviadas pela própria instância
        - A mensagem deve existir no banco de dados
        - O ID pode ser fornecido no formato completo (owner:messageid) ou apenas messageid
        - A mensagem deve estar dentro do prazo permitido pelo WhatsApp para edição
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - text
              properties:
                id:
                  type: string
                  description: ID único da mensagem que será editada (formato owner:messageid ou apenas messageid)
                  example: 3A12345678901234567890123456789012
                text:
                  type: string
                  description: Novo conteúdo de texto da mensagem
                  example: Texto editado da mensagem
      responses:
        '200':
          description: Mensagem editada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: ID único da mensagem no formato owner:messageid
                    example: 5511999999999:3A12345678901234567890123456789012
                  messageid:
                    type: string
                    description: ID da mensagem no WhatsApp
                    example: 3A12345678901234567890123456789012
                  content:
                    type: string
                    description: Conteúdo da mensagem editada
                    example: Texto editado da mensagem
                  messageTimestamp:
                    type: integer
                    description: Timestamp da mensagem (Unix timestamp em milissegundos)
                    example: 1704067200000
                  messageType:
                    type: string
                    description: Tipo da mensagem
                    example: text
                  status:
                    type: string
                    description: Status da mensagem
                    example: Pending
                  owner:
                    type: string
                    description: Proprietário da instância
                    example: '5511999999999'
        '400':
          description: Dados inválidos na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid payload
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '404':
          description: Mensagem não encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Message not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error fetching message from database
  /group/create:
    post:
      tags:
        - Grupos e Comunidades
      summary: Criar um novo grupo
      description: |
        Cria um novo grupo no WhatsApp com participantes iniciais.

        ### Detalhes
        - Requer autenticação via token da instância
        - Os números devem ser fornecidos sem formatação (apenas dígitos)

        ### Limitações
        - Mínimo de 1 participante além do criador
          
        ### Comportamento
        - Retorna informações detalhadas do grupo criado
        - Inclui lista de participantes adicionados com sucesso/falha
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Nome do grupo
                  minLength: 1
                  maxLength: 100
                  example: uazapiGO grupo
                participants:
                  type: array
                  description: Lista de números de telefone dos participantes iniciais
                  items:
                    type: string
                    description: Número de telefone sem formatação
                  minItems: 1
                  maxItems: 50
                  example:
                    - '5521987905995'
                    - '5511912345678'
              required:
                - name
                - participants
            examples:
              default:
                value:
                  name: Meu Novo Grupo
                  participants:
                    - '5521987905995'
              multiple_participants:
                value:
                  name: Equipe de Projeto
                  participants:
                    - '5521987905995'
                    - '5511912345678'
                    - '5519987654321'
      responses:
        '200':
          description: Grupo criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/group.yaml#/Group
        '400':
          description: Erro de payload inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Could not parse phone
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to create group
      security:
        - token: []
  /group/info:
    post:
      tags:
        - Grupos e Comunidades
      summary: Obter informações detalhadas de um grupo
      description: |
        Recupera informações completas de um grupo do WhatsApp, incluindo:
        - Detalhes do grupo
        - Participantes
        - Configurações
        - Link de convite (opcional)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador único do grupo (JID)
                  example: 120363153742561022@g.us
                getInviteLink:
                  type: boolean
                  description: Recuperar link de convite do grupo
                  default: false
                  example: true
                getRequestsParticipants:
                  type: boolean
                  description: Recuperar lista de solicitações pendentes de participação
                  default: false
                  example: false
                force:
                  type: boolean
                  description: Forçar atualização, ignorando cache
                  default: false
                  example: false
              required:
                - groupjid
      responses:
        '200':
          description: Informações do grupo obtidas com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/group.yaml#/Group
              example:
                JID: 120363153742561022@g.us
                Name: uazapiGO Community
                Participants:
                  - JID: 5521987654321@s.whatsapp.net
                    IsAdmin: true
                IsLocked: false
                IsAnnounce: false
        '400':
          description: Código de convite inválido ou mal formatado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid invite code
        '404':
          description: Grupo não encontrado ou link de convite expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Group invite link is invalid or has expired
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to retrieve group information
  /group/inviteInfo:
    post:
      tags:
        - Grupos e Comunidades
      summary: Obter informações de um grupo pelo código de convite
      description: |
        Retorna informações detalhadas de um grupo usando um código de convite ou URL completo do WhatsApp.

        Esta rota permite:
        - Recuperar informações básicas sobre um grupo antes de entrar
        - Validar um link de convite
        - Obter detalhes como nome do grupo, número de participantes e restrições de entrada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                inviteCode:
                  type: string
                  description: |
                    Código de convite ou URL completo do grupo.
                    Pode ser um código curto ou a URL completa do WhatsApp.
                  examples:
                    - IYnl5Zg9bUcJD32rJrDzO7
                    - https://chat.whatsapp.com/IYnl5Zg9bUcJD32rJrDzO7
              required:
                - inviteCode
      responses:
        '200':
          description: Informações do grupo obtidas com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/group.yaml#/Group
              example:
                JID: 120363153742561022@g.us
                Name: uazapiGO Community
                Participants:
                  - JID: 5521987654321@s.whatsapp.net
                    IsAdmin: true
                IsLocked: false
                IsAnnounce: false
        '400':
          description: Código de convite inválido ou mal formatado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid invite code
        '404':
          description: Grupo não encontrado ou link de convite expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Group invite link is invalid or has expired
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to retrieve group information
  /group/invitelink/:groupJID:
    get:
      tags:
        - Grupos e Comunidades
      summary: Gerar link de convite para um grupo
      description: |
        Retorna o link de convite para o grupo especificado. 
        Esta operação requer que o usuário seja um administrador do grupo.
      parameters:
        - name: groupJID
          in: path
          required: true
          schema:
            type: string
            description: JID (ID do grupo) no formato WhatsApp
            example: 120363153742561022@g.us
      responses:
        '200':
          description: Link de convite gerado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  inviteLink:
                    type: string
                    description: Link de convite completo para o grupo
                    example: https://chat.whatsapp.com/AbCdEfGhIjKlMnOpQrStUv
        '400':
          description: Erro ao processar a solicitação
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
        '403':
          description: Usuário não tem permissão para gerar link
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem indicando falta de permissão
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Detalhes do erro interno
  /group/join:
    post:
      tags:
        - Grupos e Comunidades
      summary: Entrar em um grupo usando código de convite
      description: |
        Permite entrar em um grupo do WhatsApp usando um código de convite ou URL completo. 

        Características:
        - Suporta código de convite ou URL completo
        - Valida o código antes de tentar entrar no grupo
        - Retorna informações básicas do grupo após entrada bem-sucedida
        - Trata possíveis erros como convite inválido ou expirado
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - inviteCode
              properties:
                inviteCode:
                  type: string
                  description: |
                    Código de convite ou URL completo do grupo. 
                    Formatos aceitos:
                    - Código completo: "IYnl5Zg9bUcJD32rJrDzO7"
                    - URL completa: "https://chat.whatsapp.com/IYnl5Zg9bUcJD32rJrDzO7"
                  example: https://chat.whatsapp.com/IYnl5Zg9bUcJD32rJrDzO7
                  minLength: 10
                  maxLength: 50
      responses:
        '200':
          description: Entrada no grupo realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group join successful
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '400':
          description: Código de convite inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid invite code
        '403':
          description: Usuário já está no grupo ou não tem permissão para entrar
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unable to join group
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error processing group invite
  /group/leave:
    post:
      tags:
        - Grupos e Comunidades
      summary: Sair de um grupo
      description: |
        Remove o usuário atual de um grupo específico do WhatsApp.

        Requisitos:
        - O usuário deve estar conectado a uma instância válida
        - O usuário deve ser um membro do grupo

        Comportamentos:
        - Se o usuário for o último administrador, o grupo será dissolvido
        - Se o usuário for um membro comum, será removido do grupo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: |
                    Identificador único do grupo (JID)
                    - Formato: número@g.us
                    - Exemplo válido: 120363324255083289@g.us
                  example: 120363324255083289@g.us
                  pattern: ^\d+@g\.us$
              required:
                - groupjid
      responses:
        '200':
          description: Saída do grupo realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group leave successful
        '400':
          description: Erro de payload inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        '500':
          description: Erro interno do servidor ou falha na conexão
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: error leaving group
  /group/list:
    get:
      tags:
        - Grupos e Comunidades
      summary: Listar todos os grupos
      description: |
        Retorna uma lista com todos os grupos disponíveis para a instância atual do WhatsApp.

        Recursos adicionais:
        - Suporta atualização forçada do cache de grupos
        - Recupera informações detalhadas de grupos conectados
      parameters:
        - name: force
          in: query
          schema:
            type: boolean
            default: false
          description: |
            Se definido como `true`, força a atualização do cache de grupos.
            Útil para garantir que as informações mais recentes sejam recuperadas.

            Comportamentos:
            - `false` (padrão): Usa informações em cache
            - `true`: Busca dados atualizados diretamente do WhatsApp
        - name: noparticipants
          in: query
          schema:
            type: boolean
            default: false
          description: |
            Se definido como `true`, retorna a lista de grupos sem incluir os participantes.
            Útil para otimizar a resposta quando não há necessidade dos dados dos participantes.

            Comportamentos:
            - `false` (padrão): Retorna grupos com lista completa de participantes
            - `true`: Retorna grupos sem incluir os participantes
      responses:
        '200':
          description: Lista de grupos recuperada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  groups:
                    type: array
                    items:
                      $ref: ../schemas/group.yaml#/Group
                    description: Lista detalhada de grupos
        '500':
          description: Erro interno do servidor ao recuperar grupos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem detalhando o erro encontrado
  /group/resetInviteCode:
    post:
      tags:
        - Grupos e Comunidades
      summary: Resetar código de convite do grupo
      description: |
        Gera um novo código de convite para o grupo, invalidando o código de convite anterior. 
        Somente administradores do grupo podem realizar esta ação.

        Principais características:
        - Invalida o link de convite antigo
        - Cria um novo link único
        - Retorna as informações atualizadas do grupo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador único do grupo (JID)
                  example: 120363308883996631@g.us
              required:
                - groupjid
      responses:
        '200':
          description: Código de convite resetado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  InviteLink:
                    type: string
                    description: Novo link de convite gerado
                    example: https://chat.whatsapp.com/AbCdEfGhIjKlMnOpQrStUv
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '400':
          description: Erro de validação
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Could not parse Group JID
        '403':
          description: Usuário sem permissão
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: User is not an admin of this group
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to reset group invite link
  /group/updateAnnounce:
    post:
      tags:
        - Grupos e Comunidades
      summary: Configurar permissões de envio de mensagens no grupo
      description: |
        Define as permissões de envio de mensagens no grupo, permitindo restringir o envio apenas para administradores.

        Quando ativado (announce=true):
        - Apenas administradores podem enviar mensagens
        - Outros participantes podem apenas ler
        - Útil para anúncios importantes ou controle de spam

        Quando desativado (announce=false):
        - Todos os participantes podem enviar mensagens
        - Configuração padrão para grupos normais

        Requer que o usuário seja administrador do grupo para fazer alterações.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador único do grupo no formato xxxx@g.us
                  example: 120363339858396166@g.us
                announce:
                  type: boolean
                  description: Controla quem pode enviar mensagens no grupo
                  example: true
              required:
                - groupjid
                - announce
      responses:
        '200':
          description: Configuração atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group announce enabled successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '401':
          description: Token de autenticação ausente ou inválido
        '403':
          description: Usuário não é administrador do grupo
        '404':
          description: Grupo não encontrado
        '500':
          description: Erro interno do servidor ou falha na API do WhatsApp
  /group/updateDescription:
    post:
      tags:
        - Grupos e Comunidades
      summary: Atualizar descrição do grupo
      description: |
        Altera a descrição (tópico) do grupo WhatsApp especificado.
        Requer que o usuário seja administrador do grupo.
        A descrição aparece na tela de informações do grupo e pode ser visualizada por todos os participantes.
      operationId: updateGroupDescription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - groupjid
                - description
              properties:
                groupjid:
                  type: string
                  description: JID (ID) do grupo no formato xxxxx@g.us
                  example: 120363339858396166@g.us
                  pattern: ^[0-9]+@g\.us$
                description:
                  type: string
                  description: Nova descrição/tópico do grupo
                  example: Grupo oficial de suporte
                  maxLength: 512
      responses:
        '200':
          description: Descrição atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group description updated successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '401':
          description: Token inválido ou ausente
        '403':
          description: Usuário não é administrador do grupo
        '404':
          description: Grupo não encontrado
        '413':
          description: Descrição excede o limite máximo permitido
  /group/updateImage:
    post:
      tags:
        - Grupos e Comunidades
      summary: Atualizar imagem do grupo
      description: |
        Altera a imagem do grupo especificado. A imagem pode ser enviada como URL ou como string base64.

        Requisitos da imagem:
        - Formato: JPEG
        - Resolução máxima: 640x640 pixels
        - Imagens maiores ou diferente de JPEG não são aceitas pelo WhatsApp

        Para remover a imagem atual, envie "remove" ou "delete" no campo image.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: JID do grupo
                  example: 120363308883996631@g.us
                image:
                  type: string
                  description: |
                    URL da imagem, string base64 ou "remove"/"delete" para remover.
                    A imagem deve estar em formato JPEG e ter resolução máxima de 640x640.
                  examples:
                    url:
                      value: https://example.com/image.jpg
                      summary: URL da imagem
                    base64:
                      value: data:image/jpeg;base64,/9j/4AAQSkZJRg...
                      summary: Imagem em base64
                    remove:
                      value: remove
                      summary: Remover imagem atual
              required:
                - groupjid
                - image
      parameters: []
      responses:
        '200':
          description: Imagem atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group image updated successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '400':
          description: Erro nos parâmetros da requisição
        '401':
          description: Token inválido ou expirado
        '403':
          description: Usuário não é administrador do grupo
        '413':
          description: Imagem muito grande
        '415':
          description: Formato de imagem inválido
  /group/updateLocked:
    post:
      tags:
        - Grupos e Comunidades
      summary: Configurar permissão de edição do grupo
      description: |
        Define se apenas administradores podem editar as informações do grupo. 
        Quando bloqueado (locked=true), apenas administradores podem alterar nome, descrição, 
        imagem e outras configurações do grupo. Quando desbloqueado (locked=false), 
        qualquer participante pode editar as informações.

        Importante:
        - Requer que o usuário seja administrador do grupo
        - Afeta edições de nome, descrição, imagem e outras informações do grupo
        - Não controla permissões de adição de membros
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: Identificador único do grupo (JID)
                  example: 120363308883996631@g.us
                locked:
                  type: boolean
                  description: |
                    Define permissões de edição:
                    - true = apenas admins podem editar infos do grupo
                    - false = qualquer participante pode editar infos do grupo
                  example: true
              required:
                - groupjid
                - locked
      responses:
        '200':
          description: Operação realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group lock status changed successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '403':
          description: Usuário não é administrador do grupo
        '404':
          description: Grupo não encontrado
  /group/updateName:
    post:
      tags:
        - Grupos e Comunidades
      summary: Atualizar nome do grupo
      description: |
        Altera o nome de um grupo do WhatsApp. Apenas administradores do grupo podem realizar esta operação.
        O nome do grupo deve seguir as diretrizes do WhatsApp e ter entre 1 e 25 caracteres.
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - groupjid
                - name
              properties:
                groupjid:
                  type: string
                  description: Identificador único do grupo no formato JID
                  example: 120363339858396166@g.us
                name:
                  type: string
                  description: Novo nome para o grupo
                  example: Grupo de Suporte
                  minLength: 1
                  maxLength: 25
      responses:
        '200':
          description: Nome do grupo atualizado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Group name updated successfully
                  group:
                    $ref: ../schemas/group.yaml#/Group
        '400':
          description: Erro de validação na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid payload
        '401':
          description: Token de autenticação ausente ou inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '403':
          description: Usuário não é administrador do grupo
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: User is not an admin of this group
        '404':
          description: Grupo não encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Group not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to update group name
  /group/updateParticipants:
    post:
      tags:
        - Grupos e Comunidades
      summary: Gerenciar participantes do grupo
      description: |
        Gerencia participantes do grupo através de diferentes ações:
        - Adicionar ou remover participantes
        - Promover ou rebaixar administradores
        - Aprovar ou rejeitar solicitações pendentes

        Requer que o usuário seja administrador do grupo para executar as ações.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                groupjid:
                  type: string
                  description: JID (identificador) do grupo
                  example: 120363308883996631@g.us
                action:
                  type: string
                  description: |
                    Ação a ser executada:
                    - add: Adicionar participantes ao grupo
                    - remove: Remover participantes do grupo
                    - promote: Promover participantes a administradores
                    - demote: Remover privilégios de administrador
                    - approve: Aprovar solicitações pendentes de entrada
                    - reject: Rejeitar solicitações pendentes de entrada
                  enum:
                    - add
                    - remove
                    - promote
                    - demote
                    - approve
                    - reject
                  example: promote
                participants:
                  type: array
                  items:
                    type: string
                  description: |
                    Lista de números de telefone ou JIDs dos participantes.
                    Para números de telefone, use formato internacional sem '+' ou espaços.
                  example:
                    - '5521987654321'
                    - '5511999887766'
              required:
                - groupjid
                - action
                - participants
      responses:
        '200':
          description: Sucesso na operação
          content:
            application/json:
              schema:
                type: object
                properties:
                  groupUpdated:
                    type: array
                    items:
                      type: object
                      properties:
                        JID:
                          type: string
                          description: JID do participante
                        Error:
                          type: integer
                          description: Código de erro (0 para sucesso)
                    description: Status da operação para cada participante
                  group:
                    $ref: ../schemas/group.yaml#/Group
                    description: Informações atualizadas do grupo
        '400':
          description: Erro nos parâmetros da requisição
        '403':
          description: Usuário não é administrador do grupo
        '500':
          description: Erro interno do servidor
  /community/create:
    post:
      tags:
        - Grupos e Comunidades
      summary: Criar uma comunidade
      description: >
        Cria uma nova comunidade no WhatsApp. Uma comunidade é uma estrutura que permite agrupar múltiplos grupos
        relacionados sob uma única administração. 


        A comunidade criada inicialmente terá apenas o grupo principal (announcements), e grupos adicionais podem ser
        vinculados posteriormente usando o endpoint `/community/updategroups`.


        **Observações importantes:**

        - O número que cria a comunidade torna-se automaticamente o administrador

        - A comunidade terá um grupo principal de anúncios criado automaticamente
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Nome da comunidade
                  example: Comunidade do Bairro
              required:
                - name
      responses:
        '200':
          description: Comunidade criada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  group:
                    $ref: ../schemas/group.yaml#/Group
                  failed:
                    type: array
                    description: Lista de JIDs que falharam ao serem adicionados
                    items:
                      type: string
                      format: jid
        '400':
          description: Erro na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        '401':
          description: Token inválido ou não fornecido
        '403':
          description: Sem permissão para criar comunidades
        '429':
          description: Limite de criação de comunidades atingido
        '500':
          description: Erro interno do servidor
  /community/editgroups:
    post:
      tags:
        - Grupos e Comunidades
      summary: Gerenciar grupos em uma comunidade
      description: >
        Adiciona ou remove grupos de uma comunidade do WhatsApp. Apenas administradores da comunidade podem executar
        estas operações.


        ## Funcionalidades

        - Adicionar múltiplos grupos simultaneamente a uma comunidade

        - Remover grupos de uma comunidade existente

        - Suporta operações em lote


        ## Limitações

        - Os grupos devem existir previamente

        - A comunidade deve existir e o usuário deve ser administrador

        - Grupos já vinculados não podem ser adicionados novamente

        - Grupos não vinculados não podem ser removidos


        ## Ações Disponíveis

        - `add`: Adiciona os grupos especificados à comunidade

        - `remove`: Remove os grupos especificados da comunidade
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - community
                - action
                - groupjids
              properties:
                community:
                  type: string
                  description: JID (identificador único) da comunidade
                  example: 120363153742561022@g.us
                action:
                  type: string
                  enum:
                    - add
                    - remove
                  description: |
                    Tipo de operação a ser realizada:
                    * add - Adiciona grupos à comunidade
                    * remove - Remove grupos da comunidade
                groupjids:
                  type: array
                  items:
                    type: string
                    pattern: ^[0-9]+@g.us$
                  minItems: 1
                  description: Lista de JIDs dos grupos para adicionar ou remover
                  example:
                    - 120363324255083289@g.us
                    - 120363308883996631@g.us
      responses:
        '200':
          description: Operação realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: community updated
                  success:
                    type: array
                    items:
                      type: string
                    description: Lista de JIDs dos grupos processados com sucesso
                  failed:
                    type: array
                    items:
                      type: string
                    description: Lista de JIDs dos grupos que falharam no processamento
        '400':
          description: Requisição inválida
        '401':
          description: Não autorizado
        '403':
          description: Usuário não é administrador da comunidade
  /webhook:
    get:
      tags:
        - Webhooks e SSE
      summary: Ver Webhook da Instância
      description: |
        Retorna a configuração atual do webhook da instância, incluindo:
        - URL configurada
        - Eventos ativos
        - Filtros aplicados
        - Configurações adicionais

        Exemplo de resposta:
        ```json
        [
          {
            "id": "123e4567-e89b-12d3-a456-426614174000",
            "enabled": true,
            "url": "https://example.com/webhook",
            "events": ["messages", "messages_update"],
            "excludeMessages": ["wasSentByApi", "isGroupNo"],
            "addUrlEvents": true,
            "addUrlTypesMessages": true
          },
          {
            "id": "987fcdeb-51k3-09j8-x543-864297539100",
            "enabled": true,
            "url": "https://outro-endpoint.com/webhook",
            "events": ["connection", "presence"],
            "excludeMessages": [],
            "addUrlEvents": false,
            "addUrlTypesMessages": false
          }
        ]
        ```

        A resposta é sempre um array, mesmo quando há apenas um webhook configurado.
      responses:
        '200':
          description: Configuração do webhook retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/webhook.yaml#/Webhook
              example:
                - id: 123e4567-e89b-12d3-a456-426614174000
                  enabled: true
                  url: https://example.com/webhook
                  events:
                    - messages
                    - messages_update
                  excludeMessages:
                    - wasSentByApi
                    - isGroupNo
                  addUrlEvents: true
                  addUrlTypesMessages: true
                - id: 987fcdeb-51k3-09j8-x543-864297539100
                  enabled: true
                  url: https://outro-endpoint.com/webhook
                  events:
                    - connection
                    - presence
                  excludeMessages: []
                  addUrlEvents: false
                  addUrlTypesMessages: false
        '401':
          description: Token inválido ou não fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: missing token
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to process webhook data
    post:
      tags:
        - Webhooks e SSE
      summary: Configurar Webhook da Instância
      description: >
        Gerencia a configuração de webhooks para receber eventos em tempo real da instância.

        Permite gerenciar múltiplos webhooks por instância através do campo ID e action.


        ### 🚀 Modo Simples (Recomendado)


        **Uso mais fácil - sem complexidade de IDs**:

        - Não inclua `action` nem `id` no payload

        - Gerencia automaticamente um único webhook por instância

        - Cria novo ou atualiza o existente automaticamente

        - **Recomendado**: Sempre use `"excludeMessages": ["wasSentByApi"]` para evitar loops

        - **Exemplo**: `{"url": "https://meusite.com/webhook", "events": ["messages"], "excludeMessages":
        ["wasSentByApi"]}`


        ### 🧪 Sites para Testes (ordenados por qualidade)


        **Para testar webhooks durante desenvolvimento**:

        1. **https://webhook.cool/** - ⭐ Melhor opção (sem rate limit, interface limpa)

        2. **https://rbaskets.in/** - ⭐ Boa alternativa (confiável, baixo rate limit)

        3. **https://webhook.site/** - ⚠️ Evitar se possível (rate limit agressivo)


        ### ⚙️ Modo Avançado (Para múltiplos webhooks)


        **Para usuários que precisam de múltiplos webhooks por instância**:


        💡 **Dica**: Mesmo precisando de múltiplos webhooks, considere usar `addUrlEvents` no modo simples.

        Um único webhook pode receber diferentes tipos de eventos em URLs específicas 

        (ex: `/webhook/message`, `/webhook/connection`), eliminando a necessidade de múltiplos webhooks.


        1. **Criar Novo Webhook**:
           - Use `action: "add"`
           - Não inclua `id` no payload
           - O sistema gera ID automaticamente

        2. **Atualizar Webhook Existente**:
           - Use `action: "update"`
           - Inclua o `id` do webhook no payload
           - Todos os campos serão atualizados

        3. **Remover Webhook**:
           - Use `action: "delete"`
           - Inclua apenas o `id` do webhook
           - Outros campos são ignorados



        ### Eventos Disponíveis

        - `connection`: Alterações no estado da conexão

        - `history`: Recebimento de histórico de mensagens

        - `messages`: Novas mensagens recebidas

        - `messages_update`: Atualizações em mensagens existentes

        - `call`: Eventos de chamadas VoIP

        - `contacts`: Atualizações na agenda de contatos

        - `presence`: Alterações no status de presença

        - `groups`: Modificações em grupos

        - `labels`: Gerenciamento de etiquetas

        - `chats`: Eventos de conversas

        - `chat_labels`: Alterações em etiquetas de conversas

        - `blocks`: Bloqueios/desbloqueios

        - `leads`: Atualizações de leads

        - `sender`: Atualizações de campanhas, quando inicia, e quando completa


        **Remover mensagens com base nos filtros**:

        - `wasSentByApi`: Mensagens originadas pela API ⚠️ **IMPORTANTE:** Use sempre este filtro para evitar loops em
        automações

        - `wasNotSentByApi`: Mensagens não originadas pela API

        - `fromMeYes`: Mensagens enviadas pelo usuário

        - `fromMeNo`: Mensagens recebidas de terceiros

        - `isGroupYes`: Mensagens em grupos

        - `isGroupNo`: Mensagens em conversas individuais


        💡 **Prevenção de Loops**: Se você tem automações que enviam mensagens via API, sempre inclua
        `"excludeMessages": ["wasSentByApi"]` no seu webhook. Caso prefira receber esses eventos, certifique-se de que
        sua automação detecta mensagens enviadas pela própria API para não criar loops infinitos.


        **Ações Suportadas**:

        - `add`: Registrar novo webhook

        - `delete`: Remover webhook existente


        **Parâmetros de URL**:

        - `addUrlEvents` (boolean): Quando ativo, adiciona o tipo do evento como path parameter na URL.
          Exemplo: `https://api.example.com/webhook/{evento}`
        - `addUrlTypesMessages` (boolean): Quando ativo, adiciona o tipo da mensagem como path parameter na URL.
          Exemplo: `https://api.example.com/webhook/{tipo_mensagem}`

        **Combinações de Parâmetros**:

        - Ambos ativos: `https://api.example.com/webhook/{evento}/{tipo_mensagem}`
          Exemplo real: `https://api.example.com/webhook/message/conversation`
        - Apenas eventos: `https://api.example.com/webhook/message`

        - Apenas tipos: `https://api.example.com/webhook/conversation`


        **Notas Técnicas**:

        1. Os parâmetros são adicionados na ordem: evento → tipo mensagem

        2. A URL deve ser configurada para aceitar esses parâmetros dinâmicos

        3. Funciona com qualquer combinação de eventos/mensagens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID único do webhook (necessário para update/delete)
                  example: 123e4567-e89b-12d3-a456-426614174000
                enabled:
                  type: boolean
                  description: Habilita/desabilita o webhook
                  example: true
                url:
                  type: string
                  description: URL para receber os eventos
                  example: https://example.com/webhook
                events:
                  type: array
                  description: Lista de eventos monitorados
                  items:
                    type: string
                    enum:
                      - connection
                      - history
                      - messages
                      - messages_update
                      - call
                      - contacts
                      - presence
                      - groups
                      - labels
                      - chats
                      - chat_labels
                      - blocks
                      - leads
                excludeMessages:
                  type: array
                  description: Filtros para excluir tipos de mensagens
                  items:
                    type: string
                    enum:
                      - wasSentByApi
                      - wasNotSentByApi
                      - fromMeYes
                      - fromMeNo
                      - isGroupYes
                      - isGroupNo
                addUrlEvents:
                  type: boolean
                  description: |
                    Adiciona o tipo do evento como parâmetro na URL.
                    - `false` (padrão): URL normal
                    - `true`: Adiciona evento na URL (ex: `/webhook/message`)
                  default: false
                addUrlTypesMessages:
                  type: boolean
                  description: |
                    Adiciona o tipo da mensagem como parâmetro na URL.
                    - `false` (padrão): URL normal  
                    - `true`: Adiciona tipo da mensagem (ex: `/webhook/conversation`)
                  default: false
                action:
                  type: string
                  description: |
                    Ação a ser executada:
                    - add: criar novo webhook
                    - update: atualizar webhook existente (requer id)
                    - delete: remover webhook (requer apenas id)
                    Se não informado, opera no modo simples (único webhook)
                  enum:
                    - add
                    - update
                    - delete
              required:
                - url
            examples:
              modo_simples:
                summary: Exemplo Modo Simples (Recomendado)
                description: Configuração básica sem complexidade
                value:
                  enabled: true
                  url: https://webhook.cool/example
                  events:
                    - messages
                    - connection
                  excludeMessages:
                    - wasSentByApi
              modo_avancado_criar:
                summary: Modo Avançado - Criar Webhook
                description: Criar novo webhook com ID automático
                value:
                  action: add
                  enabled: true
                  url: https://api.exemplo.com/webhook
                  events:
                    - messages
                    - groups
                  excludeMessages:
                    - wasSentByApi
              modo_simples_com_urls:
                summary: Modo Simples com URLs Dinâmicas
                description: Alternativa ao modo avançado usando addUrlEvents
                value:
                  enabled: true
                  url: https://webhook.cool/api
                  events:
                    - messages
                    - connection
                    - groups
                  excludeMessages:
                    - wasSentByApi
                  addUrlEvents: true
      responses:
        '200':
          description: Webhook configurado ou atualizado com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/webhook.yaml#/Webhook
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid action
        '401':
          description: Token inválido ou não fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: missing token
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Could not save webhook
  /globalwebhook:
    get:
      tags:
        - Admininstração
      summary: Ver Webhook Global
      security:
        - admintoken: []
      description: |
        Retorna a configuração atual do webhook global, incluindo:
        - URL configurada
        - Eventos ativos
        - Filtros aplicados
        - Configurações adicionais

        Exemplo de resposta:
        ```json
        {
          "enabled": true,
          "url": "https://example.com/webhook",
          "events": ["messages", "messages_update"],
          "excludeMessages": ["wasSentByApi", "isGroupNo"],
          "addUrlEvents": true,
          "addUrlTypesMessages": true
        }
        ```
      responses:
        '200':
          description: Configuração atual do webhook global
          content:
            application/json:
              schema:
                $ref: ../schemas/webhook.yaml#/Webhook
        '401':
          description: Token de administrador não fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '403':
          description: Token de administrador inválido ou servidor demo
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: This is a public demo server. This endpoint has been disabled.
        '404':
          description: Webhook global não encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Global webhook not found
    post:
      tags:
        - Admininstração
      summary: Configurar Webhook Global
      security:
        - admintoken: []
      description: >
        Configura um webhook global que receberá eventos de todas as instâncias.


        ### 🚀 Configuração Simples (Recomendada)


        **Para a maioria dos casos de uso**:

        - Configure apenas URL e eventos desejados

        - Modo simples por padrão (sem complexidade)

        - **Recomendado**: Sempre use `"excludeMessages": ["wasSentByApi"]` para evitar loops

        - **Exemplo**: `{"url": "https://webhook.cool/global", "events": ["messages", "connection"], "excludeMessages":
        ["wasSentByApi"]}`


        ### 🧪 Sites para Testes (ordenados por qualidade)


        **Para testar webhooks durante desenvolvimento**:

        1. **https://webhook.cool/** - ⭐ Melhor opção (sem rate limit, interface limpa)

        2. **https://rbaskets.in/** - ⭐ Boa alternativa (confiável, baixo rate limit)

        3. **https://webhook.site/** - ⚠️ Evitar se possível (rate limit agressivo)


        ### Funcionalidades Principais:

        - Configuração de URL para recebimento de eventos

        - Seleção granular de tipos de eventos

        - Filtragem avançada de mensagens

        - Parâmetros adicionais na URL


        **Eventos Disponíveis**:

        - `connection`: Alterações no estado da conexão

        - `history`: Recebimento de histórico de mensagens

        - `messages`: Novas mensagens recebidas

        - `messages_update`: Atualizações em mensagens existentes

        - `call`: Eventos de chamadas VoIP

        - `contacts`: Atualizações na agenda de contatos

        - `presence`: Alterações no status de presença

        - `groups`: Modificações em grupos

        - `labels`: Gerenciamento de etiquetas

        - `chats`: Eventos de conversas

        - `chat_labels`: Alterações em etiquetas de conversas

        - `blocks`: Bloqueios/desbloqueios

        - `leads`: Atualizações de leads

        - `sender`: Atualizações de campanhas, quando inicia, e quando completa


        **Remover mensagens com base nos filtros**:

        - `wasSentByApi`: Mensagens originadas pela API ⚠️ **IMPORTANTE:** Use sempre este filtro para evitar loops em
        automações

        - `wasNotSentByApi`: Mensagens não originadas pela API

        - `fromMeYes`: Mensagens enviadas pelo usuário

        - `fromMeNo`: Mensagens recebidas de terceiros

        - `isGroupYes`: Mensagens em grupos

        - `isGroupNo`: Mensagens em conversas individuais


        💡 **Prevenção de Loops Globais**: O webhook global recebe eventos de TODAS as instâncias. Se você tem
        automações que enviam mensagens via API, sempre inclua `"excludeMessages": ["wasSentByApi"]`. Caso prefira
        receber esses eventos, certifique-se de que sua automação detecta mensagens enviadas pela própria API para não
        criar loops infinitos em múltiplas instâncias.


        **Parâmetros de URL**:

        - `addUrlEvents` (boolean): Quando ativo, adiciona o tipo do evento como path parameter na URL.
          Exemplo: `https://api.example.com/webhook/{evento}`
        - `addUrlTypesMessages` (boolean): Quando ativo, adiciona o tipo da mensagem como path parameter na URL.
          Exemplo: `https://api.example.com/webhook/{tipo_mensagem}`

        **Combinações de Parâmetros**:

        - Ambos ativos: `https://api.example.com/webhook/{evento}/{tipo_mensagem}`
          Exemplo real: `https://api.example.com/webhook/message/conversation`
        - Apenas eventos: `https://api.example.com/webhook/message`

        - Apenas tipos: `https://api.example.com/webhook/conversation`


        **Notas Técnicas**:

        1. Os parâmetros são adicionados na ordem: evento → tipo mensagem

        2. A URL deve ser configurada para aceitar esses parâmetros dinâmicos

        3. Funciona com qualquer combinação de eventos/mensagens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                  description: URL para receber os eventos
                  example: https://webhook.cool/global
                events:
                  type: array
                  description: Lista de eventos monitorados
                  items:
                    type: string
                    enum:
                      - connection
                      - history
                      - messages
                      - messages_update
                      - call
                      - contacts
                      - presence
                      - groups
                      - labels
                      - chats
                      - chat_labels
                      - blocks
                      - leads
                      - sender
                  example:
                    - messages
                    - connection
                excludeMessages:
                  type: array
                  description: Filtros para excluir tipos de mensagens
                  items:
                    type: string
                    enum:
                      - wasSentByApi
                      - wasNotSentByApi
                      - fromMeYes
                      - fromMeNo
                      - isGroupYes
                      - isGroupNo
                  example:
                    - wasSentByApi
                addUrlEvents:
                  type: boolean
                  description: |
                    Adiciona o tipo do evento como parâmetro na URL.
                    - `false` (padrão): URL normal
                    - `true`: Adiciona evento na URL (ex: `/webhook/message`)
                  default: false
                addUrlTypesMessages:
                  type: boolean
                  description: |
                    Adiciona o tipo da mensagem como parâmetro na URL.
                    - `false` (padrão): URL normal  
                    - `true`: Adiciona tipo da mensagem (ex: `/webhook/conversation`)
                  default: false
              required:
                - url
                - events
            examples:
              configuracao_simples:
                summary: Configuração Simples (Recomendada)
                description: Configuração básica sem complexidade
                value:
                  url: https://webhook.cool/global
                  events:
                    - messages
                    - connection
                  excludeMessages:
                    - wasSentByApi
              configuracao_completa:
                summary: Configuração Completa
                description: Exemplo com todos os recursos
                value:
                  url: https://webhook.cool/api
                  events:
                    - messages
                    - connection
                    - groups
                    - leads
                  excludeMessages:
                    - wasSentByApi
                    - isGroupNo
                  addUrlEvents: true
      responses:
        '200':
          description: Webhook global configurado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/webhook.yaml#/Webhook
        '400':
          description: Payload inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid payload
        '401':
          description: Token de administrador não fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '403':
          description: Token de administrador inválido ou servidor demo
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: This is a public demo server. This endpoint has been disabled.
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to save global webhook to database
  /sse:
    get:
      tags:
        - Webhooks e SSE
      summary: Server-Sent Events (SSE)
      description: |-
        Receber eventos em tempo real via Server-Sent Events (SSE)

        ### Funcionalidades Principais:
        - Configuração de URL para recebimento de eventos
        - Seleção granular de tipos de eventos
        - Filtragem avançada de mensagens
        - Parâmetros adicionais na URL
        - Gerenciamento múltiplo de webhooks

        **Eventos Disponíveis**:
        - `connection`: Alterações no estado da conexão
        - `history`: Recebimento de histórico de mensagens
        - `messages`: Novas mensagens recebidas
        - `messages_update`: Atualizações em mensagens existentes
        - `call`: Eventos de chamadas VoIP
        - `contacts`: Atualizações na agenda de contatos
        - `presence`: Alterações no status de presença
        - `groups`: Modificações em grupos
        - `labels`: Gerenciamento de etiquetas
        - `chats`: Eventos de conversas
        - `chat_labels`: Alterações em etiquetas de conversas
        - `blocks`: Bloqueios/desbloqueios
        - `leads`: Atualizações de leads


        Estabelece uma conexão persistente para receber eventos em tempo real. Este
        endpoint:

        1. Requer autenticação via token

        2. Mantém uma conexão HTTP aberta com o cliente

        3. Envia eventos conforme ocorrem no servidor

        4. Suporta diferentes tipos de eventos

        Exemplo de uso:

        ```javascript

        const eventSource = new
        EventSource('/sse?token=SEU_TOKEN&events=chats,messages');


        eventSource.onmessage = function(event) {
          const data = JSON.parse(event.data);
          console.log('Novo evento:', data);
        };


        eventSource.onerror = function(error) {
          console.error('Erro na conexão SSE:', error);
        };

        ```


        Estrutura de um evento:

        ```json

        {
          "type": "message",
          "data": {
            "id": "3EB0538DA65A59F6D8A251",
            "from": "5511999999999@s.whatsapp.net",
            "to": "5511888888888@s.whatsapp.net",
            "text": "Olá!",
            "timestamp": 1672531200000
          }
        }

        ```
      security: []
      parameters:
        - name: token
          in: query
          schema:
            type: string
          required: true
          description: Token de autenticação da instância
          example: '{{token}}'
        - name: events
          in: query
          schema:
            type: string
          required: true
          description: Tipos de eventos a serem recebidos (separados por vírgula)
          example: chats,messages
  /agent/edit:
    post:
      tags:
        - Configuração do Agente de IA
      summary: Criar/Editar Agente
      description: >
        # Documentação dos Campos de Configuração


        ## Campos Básicos


        ### Nome e Identificação


        O agente precisa ser configurado com informações básicas que determinam sua identidade e funcionamento.


        #### Nome do Agente

        **name**: Define como o agente será identificado nas conversas.


        Exemplos válidos:

        - "Assistente de Vendas"

        - "Suporte Técnico" 

        - "João"

        - "Maria"


        #### Provedor do Serviço

        **provider**: Especifica qual serviço de IA será utilizado.


        Provedores disponíveis:

        - "openai" (ChatGPT)

        - "anthropic" (Claude)

        - "gemini" (Google)

        - "deepseek" (DeepSeek)


        #### Chave de API

        **apikey**: Credencial necessária para autenticação com o provedor escolhido.

        - Deve ser obtida através do site oficial do provedor selecionado

        - Mantenha esta chave em segurança e nunca a compartilhe


        ### Configuração do Modelo


        #### Seleção do Modelo

        **model**: Especifica qual modelo de IA será utilizado. A disponibilidade depende do provedor selecionado.


        ##### OpenAI

        Documentação: https://platform.openai.com/docs/models

        - gpt-4o

        - gpt-4o-mini

        - gpt-3.5-turbo


        ##### Claude

        Documentação: https://docs.anthropic.com/en/docs/about-claude/models

        - claude-3-5-sonnet-latest

        - claude-3-5-haiku-latest

        - claude-3-opus-latest


        ##### Gemini

        Documentação: https://ai.google.dev/models/gemini

        - gemini-2.0-flash-exp

        - gemini-1.5-pro

        - gemini-1.5-flash


        ##### DeepSeek

        Documentação: https://api-docs.deepseek.com/quick_start/pricing

        - deepseek-chat

        - deepseek-reasoner

                

        ## Configurações de Comportamento



        ### Prompt Base (**basePrompt**)



        Instruções iniciais para definir o comportamento do agente
            
        Exemplo para assistente de vendas:


        "Você é um assistente especializado em vendas, focado em ajudar clientes a encontrar os produtos ideais.
        Mantenha um tom profissional e amigável."
                
        Exemplo para suporte:


        "Você é um agente de suporte técnico especializado em nossos produtos. Forneça respostas claras e objetivas para
        ajudar os clientes a resolverem seus problemas."

                

        ### Parâmetros de Geração



        - **temperature**: Controla a criatividade das respostas (0-100)
            
            - 0-30: Respostas mais conservadoras e precisas
                
            - 30-70: Equilíbrio entre criatividade e precisão
                
            - 70-100: Respostas mais criativas e variadas

                
        - **maxTokens**: Limite máximo de tokens por resposta
            
            - Recomendado: 1000-4000 para respostas detalhadas
                
            - Para respostas curtas: 500-1000
                
            - Limite máximo varia por modelo

                
        - **diversityLevel**: Controla a diversidade das respostas (0-100)
            
            - Valores mais altos geram respostas mais variadas
                
            - Recomendado: 30-70 para uso geral

                
        - **frequencyPenalty**: Penalidade para repetição de palavras (0-100)
            
            - Valores mais altos reduzem repetições
                
            - Recomendado: 20-50 para comunicação natural

                
        - **presencePenalty**: Penalidade para manter foco no tópico (0-100)
            
            - Valores mais altos incentivam mudanças de tópico
                
            - Recomendado: 10-30 para manter coerência

                

        ## Configurações de Interação



        ### Mensagens



        - **signMessages**: Se verdadeiro, adiciona a assinatura do agente nas mensagens
            
            - Útil para identificar quem está enviando a mensagem

                
        - **readMessages**: Se verdadeiro, marca as mensagens como lidas ao responder
            
            - Recomendado para simular comportamento humano

                

        ## Exemplos de Configuração



        ### Assistente de Vendas



        ``` json


        {
          "name": "Assistente de Vendas",
          "provider": "openai",
          "model": "gpt-4",
          "basePrompt": "Você é um assistente de vendas especializado...",
          "temperature": 70,
          "maxTokens": 2000,
          "diversityLevel": 50,
          "frequencyPenalty": 30,
          "presencePenalty": 20,
          "signMessages": true,
          "readMessages": true
        }

          ```

        ### Suporte Técnico



        ``` json


        {
          "name": "Suporte Técnico",
          "provider": "anthropic",
          "model": "claude-3-sonnet-20240229",
          "basePrompt": "Você é um agente de suporte técnico...",
          "temperature": 30,
          "maxTokens": 3000,
          "diversityLevel": 40,
          "frequencyPenalty": 40,
          "presencePenalty": 15,
          "signMessages": true,
          "readMessages": true
        }

          ```

        ## Dicas de Otimização



        1. **Ajuste Gradual**: Comece com valores moderados e ajuste conforme necessário
            
        2. **Teste o Base Prompt**: Verifique se as instruções estão claras e completas
            
        3. **Monitore o Desempenho**: Observe as respostas e ajuste os parâmetros para melhor adequação
            
        4. **Backup**: Mantenha um backup das configurações que funcionaram bem
            
        5. **Documentação**: Registre as alterações e seus impactos para referência futura
      requestBody:
        content:
          application/json:
            schema:
              type: object
              example:
                id: ''
                delete: false
                agent:
                  name: uazabot
                  provider: openai
                  apikey: sk-proj-HfXFgA
                  basePrompt: Seu nome é Sara e você faz parte do time de suporte ao cliente da TechShop...
                  model: gpt-4o-mini
                  maxTokens: 2000
                  temperature: 70
                  diversityLevel: 50
                  frequencyPenalty: 30
                  presencePenalty: 30
                  signMessages: true
                  readMessages: true
                  maxMessageLength: 500
                  typingDelay_seconds: 3
                  contextTimeWindow_hours: 24
                  contextMaxMessages: 50
                  contextMinMessages: 3
      responses:
        '200':
          description: Agente atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_agent.yaml#/ChatbotAIAgent
        '201':
          description: Novo agente criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_agent.yaml#/ChatbotAIAgent
        '400':
          description: Erro na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing required fields
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '404':
          description: Agente não encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Agent not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to create agent
  /agent/list:
    get:
      tags:
        - Configuração do Agente de IA
      summary: Todos os agentes
      parameters: []
      responses:
        '200':
          description: Lista de todos os agentes de IA
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_ai_agent.yaml#/ChatbotAIAgent
        '401':
          description: Sessão não encontrada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '500':
          description: Erro ao buscar agentes
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch agents
  /sender/simple:
    post:
      tags:
        - Mensagem em massa
      summary: Criar nova campanha (Simples)
      description: Cria uma nova campanha de envio com configurações básicas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - numbers
                - type
                - folder
                - delayMin
                - delayMax
                - scheduled_for
              properties:
                numbers:
                  type: array
                  description: Lista de números para envio
                  items:
                    type: string
                  example:
                    - 5511999999999@s.whatsapp.net
                type:
                  type: string
                  description: Tipo da mensagem
                  enum:
                    - text
                    - image
                    - video
                    - audio
                    - document
                    - contact
                    - location
                    - list
                    - button
                    - poll
                    - carousel
                delayMin:
                  type: integer
                  description: Delay mínimo entre mensagens em segundos
                  minimum: 1
                  example: 10
                delayMax:
                  type: integer
                  description: Delay máximo entre mensagens em segundos
                  minimum: 1
                  example: 30
                scheduled_for:
                  type: integer
                  description: Timestamp em milissegundos ou minutos a partir de agora para agendamento
                  example: 1706198400000
                info:
                  type: string
                  description: Informações adicionais sobre a campanha
                delay:
                  type: integer
                  description: Delay fixo entre mensagens (opcional)
                mentions:
                  type: string
                  description: Menções na mensagem em formato JSON
                text:
                  type: string
                  description: Texto da mensagem
                linkPreview:
                  type: boolean
                  description: >-
                    Habilitar preview de links em mensagens de texto. O preview será gerado automaticamente a partir da
                    URL contida no texto.
                linkPreviewTitle:
                  type: string
                  description: Título personalizado para o preview do link (opcional)
                linkPreviewDescription:
                  type: string
                  description: Descrição personalizada para o preview do link (opcional)
                linkPreviewImage:
                  type: string
                  description: URL ou dados base64 da imagem para o preview do link (opcional)
                linkPreviewLarge:
                  type: boolean
                  description: Se deve usar preview grande ou pequeno (opcional, padrão false)
                file:
                  type: string
                  description: URL da mídia ou arquivo (quando type é image, video, audio, document, etc.)
                docName:
                  type: string
                  description: Nome do arquivo (quando type é document)
                fullName:
                  type: string
                  description: Nome completo (quando type é contact)
                phoneNumber:
                  type: string
                  description: Número do telefone (quando type é contact)
                organization:
                  type: string
                  description: Organização (quando type é contact)
                email:
                  type: string
                  description: Email (quando type é contact)
                url:
                  type: string
                  description: URL (quando type é contact)
                latitude:
                  type: number
                  description: Latitude (quando type é location)
                longitude:
                  type: number
                  description: Longitude (quando type é location)
                name:
                  type: string
                  description: Nome do local (quando type é location)
                address:
                  type: string
                  description: Endereço (quando type é location)
                footerText:
                  type: string
                  description: Texto do rodapé (quando type é list, button, poll ou carousel)
                buttonText:
                  type: string
                  description: Texto do botão (quando type é list, button, poll ou carousel)
                listButton:
                  type: string
                  description: Texto do botão da lista (quando type é list)
                selectableCount:
                  type: integer
                  description: Quantidade de opções selecionáveis (quando type é poll)
                choices:
                  type: array
                  items:
                    type: string
                  description: >-
                    Lista de opções (quando type é list, button, poll ou carousel). Para carousel, use formato
                    específico com [texto], {imagem} e botões
                imageButton:
                  type: string
                  description: URL da imagem para o botão (quando type é button)
      responses:
        '200':
          description: campanha criada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  folder_id:
                    type: string
                    description: ID único da campanha criada
                  count:
                    type: integer
                    description: Quantidade de mensagens agendadas
                  status:
                    type: string
                    description: Status da operação
                    example: queued
        '400':
          description: Erro nos parâmetros da requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '401':
          description: Erro de autenticação
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '409':
          description: Conflito - campanha já existe
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /sender/advanced:
    post:
      tags:
        - Mensagem em massa
      summary: Criar envio em massa avançado
      description: |
        Cria um novo envio em massa com configurações avançadas, permitindo definir
        múltiplos destinatários e mensagens com delays personalizados.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                delayMin:
                  type: integer
                  description: Delay mínimo entre mensagens (segundos)
                  minimum: 0
                  example: 3
                delayMax:
                  type: integer
                  description: Delay máximo entre mensagens (segundos)
                  minimum: 0
                  example: 6
                info:
                  type: string
                  description: Descrição ou informação sobre o envio em massa
                  example: Campanha de lançamento
                scheduled_for:
                  type: integer
                  description: Timestamp em milissegundos (date unix) ou minutos a partir de agora para agendamento
                  example: 1
                messages:
                  type: array
                  description: Lista de mensagens a serem enviadas
                  items:
                    type: object
                    required:
                      - number
                      - type
                    properties:
                      number:
                        type: string
                        description: ID do chat ou número do destinatário.
                        example: '5511999999999'
                      type:
                        type: string
                        enum:
                          - text
                          - image
                          - document
                          - audio
                          - ptt
                          - myaudio
                          - sticker
                          - video
                          - contact
                          - location
                          - poll
                          - list
                          - button
                          - carousel
                        description: |
                          Tipo da mensagem:
                          - text: Mensagem de texto
                          - image: Imagem
                          - document: Documento/arquivo
                          - audio: Áudio
                          - ptt: Mensagem de voz
                          - myaudio: Áudio (opção alternativa)
                          - sticker: Figurinha
                          - video: Vídeo
                          - contact: Contato
                          - location: Localização
                          - poll: Enquete
                          - list: Lista de opções
                          - button: Botões interativos
                          - carousel: Carrossel de cartões com imagens e botões
                      text:
                        type: string
                        description: Texto da mensagem (quando type é "text") ou legenda para mídia
                      file:
                        type: string
                        description: URL da mídia (quando type é image, video, audio, document, etc)
                      docName:
                        type: string
                        description: Nome do arquivo (quando type é document)
                      linkPreview:
                        type: boolean
                        description: >-
                          Se deve gerar preview de links (quando type é text). O preview será gerado automaticamente a
                          partir da URL contida no texto.
                      linkPreviewTitle:
                        type: string
                        description: Título personalizado para o preview do link (opcional)
                      linkPreviewDescription:
                        type: string
                        description: Descrição personalizada para o preview do link (opcional)
                      linkPreviewImage:
                        type: string
                        description: URL ou dados base64 da imagem para o preview do link (opcional)
                      linkPreviewLarge:
                        type: boolean
                        description: Se deve usar preview grande ou pequeno (opcional, padrão false)
                      fullName:
                        type: string
                        description: Nome completo (quando type é contact)
                      phoneNumber:
                        type: string
                        description: Número do telefone (quando type é contact)
                      organization:
                        type: string
                        description: Organização (quando type é contact)
                      email:
                        type: string
                        description: Email (quando type é contact)
                      url:
                        type: string
                        description: URL (quando type é contact)
                      latitude:
                        type: number
                        description: Latitude (quando type é location)
                      longitude:
                        type: number
                        description: Longitude (quando type é location)
                      name:
                        type: string
                        description: Nome do local (quando type é location)
                      address:
                        type: string
                        description: Endereço (quando type é location)
                      footerText:
                        type: string
                        description: Texto do rodapé (quando type é list, button, poll ou carousel)
                      buttonText:
                        type: string
                        description: Texto do botão (quando type é list, button, poll ou carousel)
                      listButton:
                        type: string
                        description: Texto do botão da lista (quando type é list)
                      selectableCount:
                        type: integer
                        description: Quantidade de opções selecionáveis (quando type é poll)
                      choices:
                        type: array
                        items:
                          type: string
                        description: >-
                          Lista de opções (quando type é list, button, poll ou carousel). Para carousel, use formato
                          específico com [texto], {imagem} e botões
                      imageButton:
                        type: string
                        description: URL da imagem para o botão (quando type é button)
              required:
                - messages
              example:
                delayMin: 3
                delayMax: 6
                info: teste avançado
                scheduled_for: 1
                messages:
                  - number: '5511999999999'
                    type: text
                    text: First message
                  - number: '5511999999999'
                    type: button
                    text: |-
                      Promoção Especial!
                      Confira nossas ofertas incríveis
                    footerText: Válido até 31/12/2024
                    imageButton: https://exemplo.com/banner-promocao.jpg
                    choices:
                      - Ver Ofertas|https://loja.exemplo.com/ofertas
                      - Falar com Vendedor|reply:vendedor
                      - Copiar Cupom|copy:PROMO2024
                  - number: '5511999999999'
                    type: list
                    text: 'Escolha sua categoria preferida:'
                    listButton: Ver Categorias
                    choices:
                      - '[Eletrônicos]'
                      - Smartphones|eletronicos_smartphones
                      - Notebooks|eletronicos_notebooks
                      - '[Roupas]'
                      - Camisetas|roupas_camisetas
                      - Sapatos|roupas_sapatos
                  - number: '5511999999999'
                    type: document
                    file: https://example.com/doc.pdf
                    docName: Documento.pdf
                  - number: '5511999999999'
                    type: carousel
                    text: Conheça nossos produtos
                    choices:
                      - |-
                        [Smartphone XYZ
                        O mais avançado smartphone da linha]
                      - '{https://exemplo.com/produto1.jpg}'
                      - Copiar Código|copy:PROD123
                      - Ver no Site|https://exemplo.com/xyz
                      - |-
                        [Notebook ABC
                        O notebook ideal para profissionais]
                      - '{https://exemplo.com/produto2.jpg}'
                      - Copiar Código|copy:NOTE456
                      - Comprar Online|https://exemplo.com/abc
      responses:
        '200':
          description: Mensagens adicionadas à fila com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  folder_id:
                    type: string
                    description: ID da pasta/lote criado
                  count:
                    type: integer
                    description: Total de mensagens adicionadas à fila
                  status:
                    type: string
                    description: Status da operação
                    example: queued
        '400':
          description: Erro nos parâmetros da requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
                    example: Formato de número inválido
        '401':
          description: Não autorizado - token inválido ou ausente
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem de erro
                    example: Token inválido ou ausente
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Detalhes do erro interno
  /sender/edit:
    post:
      tags:
        - Mensagem em massa
      summary: Controlar campanha de envio em massa
      description: |
        Permite controlar campanhas de envio de mensagens em massa através de diferentes ações:

        ## Ações Disponíveis:

        **🛑 stop** - Pausar campanha
        - Pausa uma campanha ativa ou agendada
        - Altera o status para "paused" 
        - Use quando quiser interromper temporariamente o envio
        - Mensagens já enviadas não são afetadas

        **▶️ continue** - Continuar campanha  
        - Retoma uma campanha pausada
        - Altera o status para "scheduled"
        - Use para continuar o envio após pausar uma campanha
        - Não funciona em campanhas já concluídas ("done")

        **🗑️ delete** - Deletar campanha
        - Remove completamente a campanha
        - Deleta apenas mensagens NÃO ENVIADAS (status "scheduled")
        - Mensagens já enviadas são preservadas no histórico
        - Operação é executada de forma assíncrona

        ## Status de Campanhas:
        - **scheduled**: Agendada para envio
        - **sending**: Enviando mensagens  
        - **paused**: Pausada pelo usuário
        - **done**: Concluída (não pode ser alterada)
        - **deleting**: Sendo deletada (operação em andamento)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                folder_id:
                  type: string
                  description: Identificador único da campanha de envio
                  example: folder_123
                action:
                  type: string
                  enum:
                    - stop
                    - continue
                    - delete
                  description: |
                    Ação a ser executada na campanha:
                    - **stop**: Pausa a campanha (muda para status "paused")
                    - **continue**: Retoma campanha pausada (muda para status "scheduled") 
                    - **delete**: Remove campanha e mensagens não enviadas (assíncrono)
                  example: stop
              required:
                - folder_id
                - action
      responses:
        '200':
          description: Ação realizada com sucesso
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    title: Resposta para ação 'stop'
                    properties:
                      status:
                        type: string
                        enum:
                          - paused
                        description: Status da campanha após pausar
                        example: paused
                  - type: object
                    title: Resposta para ação 'continue'
                    properties:
                      status:
                        type: string
                        enum:
                          - scheduled
                        description: Status da campanha após retomar
                        example: scheduled
                      message:
                        type: string
                        description: Mensagem de confirmação
                        example: Folder resumed successfully
                  - type: object
                    title: Resposta para ação 'delete'
                    properties:
                      status:
                        type: string
                        enum:
                          - deleting
                        description: Status indicando que a deleção foi iniciada
                        example: deleting
                      message:
                        type: string
                        description: Mensagem informando que a deleção é assíncrona
                        example: Folder deletion has been initiated
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: folder_id is required
  /sender/cleardone:
    post:
      tags:
        - Mensagem em massa
      summary: Limpar mensagens enviadas
      description: >-
        Inicia processo de limpeza de mensagens antigas em lote que já foram enviadas com sucesso. Por padrão, remove
        mensagens mais antigas que 7 dias.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                hours:
                  type: integer
                  description: Quantidade de horas para manter mensagens. Mensagens mais antigas que esse valor serão removidas.
                  example: 168
                  default: 168
      responses:
        '200':
          description: Limpeza iniciada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: Status da operação
                    example: cleanup started
  /sender/clearall:
    delete:
      tags:
        - Mensagem em massa
      summary: Limpar toda fila de mensagens
      description: |
        Remove todas as mensagens da fila de envio em massa, incluindo mensagens pendentes e já enviadas.
        Esta é uma operação irreversível.
      responses:
        '200':
          description: Fila de mensagens limpa com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  info:
                    type: string
                    description: Mensagem de confirmação
                    example: Fila de mensagens limpa com sucesso
        '401':
          description: Não autorizado - token inválido ou ausente
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem de erro
                    example: Token inválido ou ausente
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Detalhes do erro interno
  /sender/listfolders:
    get:
      tags:
        - Mensagem em massa
      summary: Listar campanhas de envio
      description: Retorna todas as campanhas de mensagens em massa com possibilidade de filtro por status
      security: []
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum:
              - Active
              - Archived
          description: Filtrar campanhas por status
      responses:
        '200':
          description: Lista de campanhas retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/message_queue_folder.yaml#/MessageQueueFolder
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /sender/listmessages:
    post:
      tags:
        - Mensagem em massa
      summary: Listar mensagens de uma campanha
      description: Retorna a lista de mensagens de uma campanha específica, com opções de filtro por status e paginação
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                folder_id:
                  type: string
                  description: ID da campanha a ser consultada
                messageStatus:
                  type: string
                  enum:
                    - Scheduled
                    - Sent
                    - Failed
                  description: Status das mensagens para filtrar
                page:
                  type: integer
                  minimum: 1
                  default: 1
                  description: Número da página para paginação
                pageSize:
                  type: integer
                  minimum: 1
                  maximum: 1000
                  default: 1000
                  description: Quantidade de itens por página
              required:
                - folder_id
      responses:
        '200':
          description: Lista de mensagens retornada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: ../schemas/message.yaml#/Message
                  pagination:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: Total de mensagens encontradas
                      page:
                        type: integer
                        description: Página atual
                      pageSize:
                        type: integer
                        description: Itens por página
                      lastPage:
                        type: integer
                        description: Número da última página
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: folder_id is required
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch messages
    components:
      schemas:
        MessageQueue:
          $ref: ../schemas/message.yaml#/Message
  /trigger/edit:
    post:
      tags:
        - Chatbot Trigger
      summary: Criar, atualizar ou excluir um trigger do chatbot
      description: |
        Endpoint para gerenciar triggers do chatbot. Suporta:
        - Criação de novos triggers
        - Atualização de triggers existentes
        - Exclusão de triggers por ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - trigger
              properties:
                id:
                  type: string
                  description: ID do trigger. Vazio para criação, obrigatório para atualização/exclusão
                delete:
                  type: boolean
                  description: Quando verdadeiro, exclui o trigger especificado pelo id
                  default: false
                trigger:
                  $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
            examples:
              create:
                summary: Criar novo trigger
                value:
                  id: ''
                  delete: false
                  trigger:
                    active: true
                    type: agent
                    agent_id: ref2ed7ab21d4ea
                    ignoreGroups: true
                    lead_field: lead_status
                    lead_operator: equals
                    lead_value: novo
                    priority: 1
                    wordsToStart: ola|oi|iniciar
                    responseDelay_seconds: 6
              update:
                summary: Atualizar trigger existente
                value:
                  id: r7ab21d4
                  delete: false
                  trigger:
                    active: false
                    type: agent
                    agent_id: ref2ed7ab21d4ea
              delete:
                summary: Excluir trigger
                value:
                  id: r7ab21d4
                  delete: true
      responses:
        '200':
          description: Trigger atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
        '201':
          description: Trigger criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
        '400':
          description: Corpo da requisição inválido ou campos obrigatórios ausentes
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '404':
          description: Trigger não encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '500':
          description: Erro no servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /trigger/list:
    get:
      tags:
        - Chatbot Trigger
      summary: Listar todos os triggers do chatbot
      description: Retorna a lista completa de triggers configurados para a instância atual
      parameters: []
      responses:
        '200':
          description: Lista de triggers retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_trigger.yaml#/ChatbotTrigger
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '500':
          description: Erro no servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch triggers
  /knowledge/edit:
    post:
      tags:
        - Conhecimento dos Agentes
      summary: Criar/Editar Conhecimento do Agente
      description: |
        Gerencia o conhecimento base usado pelos agentes de IA para responder consultas.
        O conhecimento pode ser fornecido como texto direto ou através de arquivos PDF/CSV.

        Características principais:
        - Suporta criação, edição e exclusão de conhecimento
        - Aceita conteúdo em:
          - Texto puro
          - URLs públicas
          - Base64 encoded de arquivos
          - Upload direto de arquivos
        - Formatos suportados: PDF, CSV, TXT, HTML
        - Processa automaticamente qualquer formato de entrada
        - Vetoriza automaticamente o conteúdo para busca semântica

        Nota sobre URLs e Base64:
        - URLs devem ser públicas e acessíveis
        - Para PDFs/CSVs, especifique fileType se não for detectável da extensão
        - Base64 deve incluir o encoding completo do arquivo
        - O servidor detecta e processa automaticamente conteúdo Base64
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: ID do conhecimento (vazio para criar novo)
                delete:
                  type: boolean
                  description: Define se é uma operação de exclusão
                knowledge:
                  type: object
                  properties:
                    isActive:
                      type: boolean
                      description: Status de ativação do conhecimento
                    tittle:
                      type: string
                      description: Título identificador do conhecimento
                    content:
                      type: string
                      description: Conteúdo textual, URL ou Base64
                fileType:
                  type: string
                  enum:
                    - pdf
                    - txt
                    - html
                    - csv
                  description: Tipo do arquivo quando não detectado automaticamente
              example:
                id: ''
                delete: false
                knowledge:
                  isActive: true
                  tittle: Informações sobre a uazapi
                  content: A uazapi foi originalmente desenvolvida...
      responses:
        '200':
          description: Conhecimento atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_knowledge.yaml#/ChatbotAIKnowledge
        '201':
          description: Novo conhecimento criado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_knowledge.yaml#/ChatbotAIKnowledge
        '400':
          description: Requisição inválida
        '404':
          description: Conhecimento não encontrado
        '500':
          description: Erro interno do servidor
  /knowledge/list:
    get:
      tags:
        - Conhecimento dos Agentes
      summary: Listar Base de Conhecimento
      description: |
        Retorna todos os conhecimentos cadastrados para o agente de IA da instância.
        Estes conhecimentos são utilizados pelo chatbot para responder perguntas
        e interagir com os usuários de forma contextualizada.
      parameters: []
      responses:
        '200':
          description: Lista de conhecimentos recuperada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_ai_knowledge.yaml#/ChatbotAIKnowledge
        '401':
          description: Token de autenticação ausente ou inválido
        '500':
          description: Erro interno do servidor ao buscar conhecimentos
  /function/edit:
    post:
      tags:
        - Funções API dos Agentes
      summary: Criar/Editar função para integração com APIs externas
      description: >
        # Configuração de Funções de API para Agentes IA


        Documentação para criar/editar funções utilizadas pelos agentes de IA para integração com APIs externas. Inclui
        validação automática e controle de ativação.


        ## 1. Estrutura Base da Função


        ### Campos Principais

        ```json

        {
          "name": "nomeDaFuncao",
          "description": "Descrição detalhada",
          "isActive": true,
          "method": "POST",
          "endpoint": "https://api.exemplo.com/recurso",
          "headers": {},
          "body": {},
          "parameters": []
        }

        ```


        ### Detalhamento dos Campos


        #### `name`

        - Identificador único e descritivo

        - Sem espaços ou caracteres especiais

        - Ex: "createProduct", "updateUserStatus"


        #### `description`

        - Propósito e funcionamento da função

        - Inclua casos de uso e resultados esperados

        - Ex: "Cria produto no catálogo com nome, preço e categoria"


        #### `isActive`

        - Controla disponibilidade da função

        - Desativa automaticamente se houver erros

        - Default: false


        #### `method`

        - GET: buscar dados

        - POST: criar recurso

        - PUT: atualizar completo

        - PATCH: atualização parcial

        - DELETE: remover recurso


        #### `endpoint`

        - URL completa da API

        - Aceita placeholders: {{variavel}}

        - Exemplos:
          ```
          https://api.exemplo.com/produtos
          https://api.exemplo.com/usuarios/{{userId}}
          https://api.exemplo.com/busca?q={{query}}&limit={{limit}}
          ```

        #### `headers`

        ```json

        {
          "Authorization": "Bearer {{apiKey}}",
          "Content-Type": "application/json",
          "Accept": "application/json"
        }

        ```


        #### `body` (POST/PUT/PATCH)

        ```json

        {
          "name": "{{productName}}",
          "price": "{{price}}",
          "metadata": {
            "tags": "{{tags}}"
          }
        }

        ```


        ## 2. Configuração de Parâmetros


        ### Estrutura do Parâmetro

        ```json

        {
          "name": "nomeParametro",
          "type": "string",
          "description": "Descrição do uso",
          "required": true,
          "enum": "valor1,valor2,valor3",
          "minimum": 0,
          "maximum": 100
        }

        ```


        ### Tipos de Parâmetros


        #### String

        ```json

        {
          "name": "status",
          "type": "string",
          "description": "Status do pedido",
          "required": true,
          "enum": "pending,processing,completed"
        }

        ```


        #### Número

        ```json

        {
          "name": "price",
          "type": "number",
          "description": "Preço em reais",
          "required": true,
          "minimum": 0.01,
          "maximum": 99999.99
        }

        ```


        #### Inteiro

        ```json

        {
          "name": "quantity",
          "type": "integer",
          "description": "Quantidade",
          "minimum": 0,
          "maximum": 1000
        }

        ```


        #### Boolean

        ```json

        {
          "name": "active",
          "type": "boolean",
          "description": "Status de ativação"
        }

        ```


        ## 3. Sistema de Validação


        ### Validações Automáticas

        1. JSON
          - Headers e body devem ser válidos
          - Erros desativam a função

        2. Placeholders ({{variavel}})
          - Case-sensitive
          - Devem ter parâmetro correspondente

        3. Parâmetros
          - Nomes únicos
          - Tipos corretos
          - Limites numéricos válidos
          - Enums sem valores vazios

        ### Erros e Avisos

        - Função desativa se houver:
          - JSON inválido
          - Parâmetros não documentados
          - Violações de tipo
        - Erros aparecem em `undocumentedParameters`


        ## 4. Exemplo Completo


        ```json

        {
          "name": "createProduct",
          "description": "Criar novo produto no catálogo",
          "isActive": true,
          "method": "POST",
          "endpoint": "https://api.store.com/v1/products",
          "headers": {
            "Authorization": "Bearer {{apiKey}}",
            "Content-Type": "application/json"
          },
          "body": {
            "name": "{{productName}}",
            "price": "{{price}}",
            "category": "{{category}}"
          },
          "parameters": [
            {
              "name": "apiKey",
              "type": "string",
              "description": "Chave de API",
              "required": true
            },
            {
              "name": "productName",
              "type": "string",
              "description": "Nome do produto",
              "required": true
            },
            {
              "name": "price",
              "type": "number",
              "description": "Preço em reais",
              "required": true,
              "minimum": 0.01
            },
            {
              "name": "category",
              "type": "string",
              "description": "Categoria do produto",
              "required": true,
              "enum": "electronics,clothing,books"
            }
          ]
        }

        ```
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - delete
                - function
              properties:
                id:
                  type: string
                  description: ID da função. Vazio para criar nova, preenchido para editar existente.
                delete:
                  type: boolean
                  description: Se true, deleta a função especificada pelo ID.
                function:
                  type: object
                  required:
                    - name
                    - description
                    - method
                    - endpoint
                  properties:
                    name:
                      type: string
                      description: Nome da função
                      example: createProduct
                    isActive:
                      type: boolean
                      description: Status de ativação da função
                      default: false
                    description:
                      type: string
                      description: Descrição detalhada da função e seu propósito
                      example: Cria um novo produto no catálogo
                    method:
                      type: string
                      description: Método HTTP da requisição
                      enum:
                        - GET
                        - POST
                        - PUT
                        - DELETE
                        - PATCH
                      example: POST
                    endpoint:
                      type: string
                      description: URL do endpoint da API
                      example: https://api.example.com/products
                    headers:
                      type: object
                      description: Cabeçalhos da requisição. Suporta placeholders no formato {{variavel}}
                      example:
                        Authorization: Bearer {{apiKey}}
                        Content-Type: application/json
                    body:
                      type: object
                      description: Corpo da requisição. Suporta placeholders no formato {{variavel}}
                      example:
                        name: '{{productName}}'
                        price: '{{price}}'
                        category: '{{category}}'
                    parameters:
                      type: array
                      description: Lista de parâmetros aceitos pela função
                      items:
                        type: object
                        required:
                          - name
                          - type
                          - description
                        properties:
                          name:
                            type: string
                            description: Nome do parâmetro
                          type:
                            type: string
                            enum:
                              - string
                              - number
                              - integer
                              - boolean
                              - array
                              - object
                            description: Tipo do parâmetro
                          description:
                            type: string
                            description: Descrição do parâmetro
                          required:
                            type: boolean
                            description: Indica se o parâmetro é obrigatório
                          enum:
                            type: string
                            description: Lista de valores permitidos para parâmetros do tipo string, separados por vírgula
                          minimum:
                            type: number
                            description: Valor mínimo para parâmetros numéricos
                          maximum:
                            type: number
                            description: Valor máximo para parâmetros numéricos
                      example:
                        - name: apiKey
                          type: string
                          description: Chave de API para autenticação
                          required: true
                        - name: price
                          type: number
                          description: Preço do produto
                          minimum: 0.01
                          maximum: 999999.99
                          required: true
      responses:
        '200':
          description: Função atualizada com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_function.yaml#/ChatbotAIFunction
        '201':
          description: Nova função criada com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chatbot_ai_function.yaml#/ChatbotAIFunction
        '400':
          description: Erro de validação nos dados fornecidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '404':
          description: Função não encontrada
        '500':
          description: Erro interno do servidor
  /function/list:
    get:
      tags:
        - Funções API dos Agentes
      summary: Lista todas as funções de API
      description: Retorna todas as funções de API configuradas para a instância atual
      responses:
        '200':
          description: Lista de funções recuperada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/chatbot_ai_function.yaml#/ChatbotAIFunction
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  /chat/block:
    post:
      summary: Bloqueia ou desbloqueia contato do WhatsApp
      description: |
        Bloqueia ou desbloqueia um contato do WhatsApp. Contatos bloqueados não podem enviar mensagens 
        para a instância e a instância não pode enviar mensagens para eles.
      tags:
        - Bloqueios
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do WhatsApp no formato internacional (ex. 5511999999999)
                  example: '5511999999999'
                block:
                  type: boolean
                  description: True para bloquear, False para desbloquear
                  example: true
              required:
                - number
                - block
      responses:
        '200':
          description: Operação realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                    example: Blocked successfully
                  blockList:
                    type: array
                    description: Lista atualizada de contatos bloqueados
                    items:
                      type: string
                    example:
                      - 5511999999999@s.whatsapp.net
                      - 5511888888888@s.whatsapp.net
        '401':
          description: Não autorizado - token inválido
        '404':
          description: Contato não encontrado
        '500':
          description: Erro do servidor ao processar a requisição
  /chat/blocklist:
    get:
      summary: Lista contatos bloqueados
      description: |
        Retorna a lista completa de contatos que foram bloqueados pela instância.
        Esta lista é atualizada em tempo real conforme contatos são bloqueados/desbloqueados.
      tags:
        - Bloqueios
      responses:
        '200':
          description: Lista de contatos bloqueados recuperada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  blockList:
                    type: array
                    items:
                      type: string
                      description: JIDs dos contatos bloqueados no formato "número@s.whatsapp.net"
                    example:
                      - 5511999999999@s.whatsapp.net
                      - 5511888888888@s.whatsapp.net
        '401':
          description: Token inválido ou não fornecido
        '500':
          description: Erro interno do servidor ou instância não conectada
  /chat/labels:
    post:
      summary: Gerencia labels de um chat
      description: >
        Atualiza as labels associadas a um chat específico. Este endpoint oferece três modos de operação:


        1. **Definir todas as labels** (labelids): Define o conjunto completo de labels para o chat, substituindo labels
        existentes

        2. **Adicionar uma label** (add_labelid): Adiciona uma única label ao chat sem afetar as existentes

        3. **Remover uma label** (remove_labelid): Remove uma única label do chat sem afetar as outras


        **Importante**: Use apenas um dos três parâmetros por requisição. Labels inexistentes serão rejeitadas.


        As labels devem ser fornecidas no formato id ou labelid encontradas na função get labels.
      tags:
        - Etiquetas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do chat ou grupo
                  example: '5511999999999'
                labelids:
                  type: array
                  items:
                    type: string
                  description: Lista de IDs das labels a serem aplicadas ao chat (define todas as labels)
                  example:
                    - '10'
                    - '20'
                add_labelid:
                  type: string
                  description: ID da label a ser adicionada ao chat
                  example: '10'
                remove_labelid:
                  type: string
                  description: ID da label a ser removida do chat
                  example: '20'
              required:
                - number
              oneOf:
                - required:
                    - labelids
                - required:
                    - add_labelid
                - required:
                    - remove_labelid
            examples:
              definir_todas_labels:
                summary: Definir todas as labels do chat
                description: Define o conjunto completo de labels, substituindo as existentes
                value:
                  number: '5511999999999'
                  labelids:
                    - '10'
                    - '20'
                    - '30'
              adicionar_label:
                summary: Adicionar uma label ao chat
                description: Adiciona uma única label sem afetar as existentes
                value:
                  number: '5511999999999'
                  add_labelid: '10'
              remover_label:
                summary: Remover uma label do chat
                description: Remove uma única label sem afetar as outras
                value:
                  number: '5511999999999'
                  remove_labelid: '20'
      responses:
        '200':
          description: Labels atualizadas com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                  editions:
                    type: array
                    items:
                      type: string
                    description: Lista de operações realizadas (apenas para operação labelids)
              examples:
                definir_todas_labels:
                  summary: Resposta para definir todas as labels
                  value:
                    response: Labels updated successfully
                    editions:
                      - Added label 10 to chat
                      - Added label 20 to chat
                      - Removed label 5 from chat
                adicionar_label:
                  summary: Resposta para adicionar uma label
                  value:
                    response: Label added to chat
                remover_label:
                  summary: Resposta para remover uma label
                  value:
                    response: Label removed from chat
        '400':
          description: Erro na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: 'Use only one operation: labelids, add_labelid, or remove_labelid'
        '404':
          description: Chat não encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Chat not found
  /chat/delete:
    post:
      summary: Deleta chat
      description: |
        Deleta um chat e/ou suas mensagens do WhatsApp e/ou banco de dados. 
        Você pode escolher deletar:
        - Apenas do WhatsApp
        - Apenas do banco de dados
        - Apenas as mensagens do banco de dados
        - Qualquer combinação das opções acima
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: |
                    Número do chat no formato internacional.
                    Para grupos use o ID completo do grupo.
                  example: '5511999999999'
                deleteChatDB:
                  type: boolean
                  description: Se true, deleta o chat do banco de dados
                  default: false
                  example: true
                deleteMessagesDB:
                  type: boolean
                  description: Se true, deleta todas as mensagens do chat do banco de dados
                  default: false
                  example: true
                deleteChatWhatsApp:
                  type: boolean
                  description: Se true, deleta o chat do WhatsApp
                  default: false
                  example: true
              required:
                - number
      responses:
        '200':
          description: Operação realizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de sucesso
                    example: Chat deletion process completed
                  actions:
                    type: array
                    description: Lista de ações realizadas
                    items:
                      type: string
                    example:
                      - Chat deleted from WhatsApp
                      - Chat deleted from database
                      - 'Messages associated with chat deleted from database: 42'
                  errors:
                    type: array
                    description: Lista de erros ocorridos, se houver
                    items:
                      type: string
                    example:
                      - 'Error deleting chat from WhatsApp: connection timeout'
        '400':
          description: Erro nos parâmetros da requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing number in payload
        '401':
          description: Token inválido ou não fornecido
        '404':
          description: Chat não encontrado
        '500':
          description: Erro interno do servidor
  /chat/archive:
    post:
      summary: Arquivar/desarquivar chat
      description: |
        Altera o estado de arquivamento de um chat do WhatsApp.
        - Quando arquivado, o chat é movido para a seção de arquivados no WhatsApp
        - A ação é sincronizada entre todos os dispositivos conectados
        - Não afeta as mensagens ou o conteúdo do chat
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - archive
              properties:
                number:
                  type: string
                  description: Número do telefone (formato E.164) ou ID do grupo
                  example: '5511999999999'
                archive:
                  type: boolean
                  description: true para arquivar, false para desarquivar
                  example: true
      responses:
        '200':
          description: Chat arquivado/desarquivado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Chat updated successfully
        '400':
          description: Dados da requisição inválidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid phone number format
        '401':
          description: Token de autenticação ausente ou inválido
        '500':
          description: Erro ao executar a operação
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Error archiving chat
  /chat/read:
    post:
      summary: Marcar chat como lido/não lido
      description: |
        Atualiza o status de leitura de um chat no WhatsApp.

        Quando um chat é marcado como lido:
        - O contador de mensagens não lidas é zerado
        - O indicador visual de mensagens não lidas é removido
        - O remetente recebe confirmação de leitura (se ativado)

        Quando marcado como não lido:
        - O chat aparece como pendente de leitura
        - Não afeta as confirmações de leitura já enviadas
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - read
              properties:
                number:
                  type: string
                  description: |
                    Identificador do chat no formato:
                    - Para usuários: [número]@s.whatsapp.net (ex: 5511999999999@s.whatsapp.net)
                    - Para grupos: [id-grupo]@g.us (ex: 123456789-987654321@g.us)
                  example: 5511999999999@s.whatsapp.net
                read:
                  type: boolean
                  description: |
                    - true: marca o chat como lido
                    - false: marca o chat como não lido
      responses:
        '200':
          description: Status de leitura atualizado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Chat read status updated successfully
        '401':
          description: Token de autenticação ausente ou inválido
        '404':
          description: Chat não encontrado
        '500':
          description: Erro ao atualizar status de leitura
  /chat/mute:
    post:
      summary: Silenciar chat
      description: |
        Silencia notificações de um chat por um período específico. 
        As opções de silenciamento são:
        * 0 - Remove o silenciamento
        * 8 - Silencia por 8 horas
        * 168 - Silencia por 1 semana (168 horas)
        * -1 - Silencia permanentemente
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - number
                - muteEndTime
              properties:
                number:
                  type: string
                  description: ID do chat no formato 123456789@s.whatsapp.net ou 123456789-123456@g.us
                  example: 5511999999999@s.whatsapp.net
                muteEndTime:
                  type: integer
                  description: |
                    Duração do silenciamento:
                    * 0 = Remove silenciamento
                    * 8 = Silencia por 8 horas
                    * 168 = Silencia por 1 semana
                    * -1 = Silencia permanentemente
                  enum:
                    - 0
                    - 8
                    - 168
                    - -1
                  example: 8
      responses:
        '200':
          description: Chat silenciado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Chat mute settings updated successfully
        '400':
          description: Duração inválida ou formato de número incorreto
        '401':
          description: Token inválido ou ausente
        '404':
          description: Chat não encontrado
  /chat/pin:
    post:
      summary: Fixar/desafixar chat
      description: |
        Fixa ou desafixa um chat no topo da lista de conversas. Chats fixados permanecem 
        no topo mesmo quando novas mensagens são recebidas em outros chats.
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: |
                    Número do chat no formato internacional completo (ex: "5511999999999") 
                    ou ID do grupo (ex: "123456789-123456@g.us")
                  example: '5511999999999'
                pin:
                  type: boolean
                  description: |
                    Define se o chat deve ser fixado (true) ou desafixado (false)
                  example: true
              required:
                - number
                - pin
      responses:
        '200':
          description: Chat fixado/desafixado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                    example: Chat pinned
        '400':
          description: Erro na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
                    example: Could not parse phone
        '401':
          description: Não autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Mensagem de erro de autenticação
                    example: Invalid token
  /chat/find:
    post:
      summary: Busca chats com filtros
      description: |
        Busca chats com diversos filtros e ordenação. Suporta filtros em todos os campos do chat, 
        paginação e ordenação customizada.

        Operadores de filtro:
        - `~` : LIKE (contém)
        - `!~` : NOT LIKE (não contém)
        - `!=` : diferente
        - `>=` : maior ou igual
        - `>` : maior que
        - `<=` : menor ou igual
        - `<` : menor que
        - Sem operador: LIKE (contém)
      tags:
        - Chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                operator:
                  type: string
                  enum:
                    - AND
                    - OR
                  default: AND
                  description: Operador lógico entre os filtros
                sort:
                  type: string
                  description: Campo para ordenação (+/-campo). Ex -wa_lastMsgTimestamp
                limit:
                  type: integer
                  description: Limite de resultados por página
                  default: 2000
                offset:
                  type: integer
                  description: Offset para paginação
                  default: 0
                wa_fastid:
                  type: string
                wa_chatid:
                  type: string
                wa_archived:
                  type: boolean
                wa_contactName:
                  type: string
                wa_name:
                  type: string
                name:
                  type: string
                wa_isBlocked:
                  type: boolean
                wa_isGroup:
                  type: boolean
                wa_isGroup_admin:
                  type: boolean
                wa_isGroup_announce:
                  type: boolean
                wa_isGroup_member:
                  type: boolean
                wa_isPinned:
                  type: boolean
                wa_label:
                  type: string
                lead_tags:
                  type: string
                lead_isTicketOpen:
                  type: boolean
                lead_assignedAttendant_id:
                  type: string
                lead_status:
                  type: string
              example:
                operator: AND
                sort: '-wa_lastMsgTimestamp'
                limit: 50
                offset: 0
                wa_isGroup: true
                lead_status: ~novo
                wa_label: ~importante
      responses:
        '200':
          description: Lista de chats encontrados
          content:
            application/json:
              schema:
                type: object
                properties:
                  chats:
                    type: array
                    items:
                      $ref: ../schemas/chat.yaml#/Chat
                  totalChatsStats:
                    type: object
                    description: Contadores totais de chats
                  pagination:
                    type: object
                    properties:
                      totalRecords:
                        type: integer
                      pageSize:
                        type: integer
                      currentPage:
                        type: integer
                      totalPages:
                        type: integer
  /chat/count:
    get:
      summary: Retorna contadores de chats
      description: |
        Retorna estatísticas e contadores agregados dos chats, incluindo:
        - Total de chats
        - Chats não lidos
        - Chats arquivados
        - Chats fixados
        - Chats bloqueados
        - Grupos e status de grupos
      tags:
        - Chats
      responses:
        '200':
          description: Contadores retornados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_chats:
                    type: integer
                    description: Número total de chats
                  unread_chats:
                    type: integer
                    description: Número de chats com mensagens não lidas
                  archived_chats:
                    type: integer
                    description: Número de chats arquivados
                  pinned_chats:
                    type: integer
                    description: Número de chats fixados
                  blocked_chats:
                    type: integer
                    description: Número de contatos bloqueados
                  groups:
                    type: integer
                    description: Número total de grupos
                  admin_groups:
                    type: integer
                    description: Número de grupos onde é administrador
                  member_groups:
                    type: integer
                    description: Número de grupos onde é membro
                example:
                  total_chats: 150
                  unread_chats: 5
                  archived_chats: 10
                  pinned_chats: 3
                  blocked_chats: 2
                  groups: 8
                  admin_groups: 3
                  member_groups: 5
        '401':
          description: Não autorizado - token inválido
        '500':
          description: Erro interno do servidor
  /chat/editLead:
    post:
      summary: Edita informações de lead
      description: |
        Atualiza as informações de lead associadas a um chat. Permite modificar status do ticket, 
        atribuição de atendente, posição no kanban, tags e outros campos customizados.

        As alterações são refletidas imediatamente no banco de dados e disparam eventos webhook/SSE
        para manter a aplicação sincronizada.
      tags:
        - CRM
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
              properties:
                id:
                  type: string
                  description: |
                    Identificador do chat. Pode ser:
                    - wa_chatid (ex: "5511999999999@s.whatsapp.net")
                    - wa_fastid (ex: "5511888888888:5511999999999")
                  example: 5511999999999@s.whatsapp.net
                chatbot_disableUntil:
                  type: integer
                  format: int64
                  description: |
                    Timestamp UTC até quando o chatbot deve ficar desativado para este chat.
                    Use 0 para reativar imediatamente.
                  example: 1735686000
                lead_isTicketOpen:
                  type: boolean
                  description: |
                    Status do ticket associado ao lead.
                    - true: Ticket está aberto/em atendimento
                    - false: Ticket está fechado/resolvido
                  example: true
                lead_assignedAttendant_id:
                  type: string
                  description: |
                    ID do atendente atribuído ao lead.
                    Use string vazia ("") para remover a atribuição.
                  example: att_123456
                lead_kanbanOrder:
                  type: integer
                  format: int64
                  description: |
                    Posição do card no quadro kanban.
                    Valores maiores aparecem primeiro.
                  example: 1000
                lead_tags:
                  type: array
                  items:
                    type: string
                  description: |
                    Lista de tags associadas ao lead.
                    Tags inexistentes são criadas automaticamente.
                    Envie array vazio ([]) para remover todas as tags.
                  example:
                    - vip
                    - suporte
                    - prioridade-alta
                lead_name:
                  type: string
                  description: Nome principal do lead
                  example: João Silva
                lead_fullName:
                  type: string
                  description: Nome completo do lead
                  example: João Silva Pereira
                lead_email:
                  type: string
                  format: email
                  description: Email do lead
                  example: joao@exemplo.com
                lead_personalId:
                  type: string
                  description: |
                    Documento de identificação (CPF/CNPJ)
                    Apenas números ou formatado
                  example: 123.456.789-00
                lead_status:
                  type: string
                  description: Status do lead no funil de vendas
                  example: qualificado
                lead_notes:
                  type: string
                  description: Anotações sobre o lead
                  example: Cliente interessado em plano premium
                lead_field01:
                  type: string
                  description: Campo personalizado 1
                lead_field02:
                  type: string
                  description: Campo personalizado 2
                lead_field03:
                  type: string
                  description: Campo personalizado 3
                lead_field04:
                  type: string
                  description: Campo personalizado 4
                lead_field05:
                  type: string
                  description: Campo personalizado 5
                lead_field06:
                  type: string
                  description: Campo personalizado 6
                lead_field07:
                  type: string
                  description: Campo personalizado 7
                lead_field08:
                  type: string
                  description: Campo personalizado 8
                lead_field09:
                  type: string
                  description: Campo personalizado 9
                lead_field10:
                  type: string
                  description: Campo personalizado 10
                lead_field11:
                  type: string
                  description: Campo personalizado 11
                lead_field12:
                  type: string
                  description: Campo personalizado 12
                lead_field13:
                  type: string
                  description: Campo personalizado 13
                lead_field14:
                  type: string
                  description: Campo personalizado 14
                lead_field15:
                  type: string
                  description: Campo personalizado 15
                lead_field16:
                  type: string
                  description: Campo personalizado 16
                lead_field17:
                  type: string
                  description: Campo personalizado 17
                lead_field18:
                  type: string
                  description: Campo personalizado 18
                lead_field19:
                  type: string
                  description: Campo personalizado 19
                lead_field20:
                  type: string
                  description: Campo personalizado 20
      responses:
        '200':
          description: Lead atualizado com sucesso
          content:
            application/json:
              schema:
                $ref: ../schemas/chat.yaml#/Chat
              example:
                wa_fastid: '5511888888888:5511999999999'
                wa_chatid: 5511999999999@s.whatsapp.net
                lead_name: João Silva
                lead_status: qualificado
                lead_tags:
                  - vip
                  - suporte
                lead_isTicketOpen: true
                lead_assignedAttendant_id: att_123456
        '400':
          description: Payload inválido
        '404':
          description: Chat não encontrado
        '500':
          description: Erro interno do servidor
  /contacts:
    get:
      tags:
        - Contatos
      summary: Retorna lista de contatos do WhatsApp
      description: |
        Retorna a lista de contatos salvos na agenda do celular e que estão no WhatsApp.

        O endpoint realiza:
        - Busca todos os contatos armazenados
        - Retorna dados formatados incluindo JID e informações de nome
      security:
        - token: []
      responses:
        '200':
          description: Lista de contatos retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    jid:
                      type: string
                      description: 'ID único do contato no WhatsApp (formato: número@s.whatsapp.net)'
                      example: 5511999999999@s.whatsapp.net
                    contactName:
                      type: string
                      description: Nome completo do contato
                      example: João Silva
                    contact_FirstName:
                      type: string
                      description: Primeiro nome do contato
                      example: João
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Internal server error
  /contact/add:
    post:
      tags:
        - Contatos
      summary: Adiciona um contato à agenda
      description: |
        Adiciona um novo contato à agenda do celular.

        O endpoint realiza:
        - Adiciona o contato à agenda usando o WhatsApp
        - Usa o campo 'name' tanto para o nome completo quanto para o primeiro nome
        - Salva as informações do contato na agenda do WhatsApp
        - Retorna informações do contato adicionado
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone
                - name
              properties:
                phone:
                  type: string
                  description: |
                    Número de telefone no formato internacional com código do país obrigatório. 
                    Para Brasil, deve começar com 55. Aceita variações com/sem símbolo +, 
                    com/sem parênteses, com/sem hífen e com/sem espaços. Também aceita formato 
                    JID do WhatsApp (@s.whatsapp.net). Não aceita contatos comerciais (@lid) 
                    nem grupos (@g.us).
                  examples:
                    - +55 (21) 99999-9999
                    - +55 21 99999-9999
                    - +55 21 999999999
                    - '+5521999999999'
                    - '5521999999999'
                    - 5521999999999@s.whatsapp.net
                name:
                  type: string
                  description: Nome completo do contato (será usado como primeiro nome e nome completo)
                  example: João Silva
      responses:
        '200':
          description: Contato adicionado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Contato adicionado com sucesso
                  contact:
                    type: object
                    properties:
                      jid:
                        type: string
                        description: 'ID único do contato no WhatsApp (formato: número@s.whatsapp.net)'
                        example: 5511999999999@s.whatsapp.net
                      name:
                        type: string
                        description: Nome completo do contato
                        example: João Silva
                      phone:
                        type: string
                        description: Número de telefone
                        example: '5511999999999'
        '400':
          description: Dados inválidos na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Número de telefone inválido
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao adicionar contato
  /contact/remove:
    post:
      tags:
        - Contatos
      summary: Remove um contato da agenda
      description: |
        Remove um contato da agenda do celular.

        O endpoint realiza:
        - Remove o contato da agenda usando o WhatsApp AppState
        - Atualiza a lista de contatos sincronizada
        - Retorna confirmação da remoção
      security:
        - token: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone
              properties:
                phone:
                  type: string
                  description: |
                    Número de telefone no formato internacional com código do país obrigatório. 
                    Para Brasil, deve começar com 55. Aceita variações com/sem símbolo +, 
                    com/sem parênteses, com/sem hífen e com/sem espaços. Também aceita formato 
                    JID do WhatsApp (@s.whatsapp.net). Não aceita contatos comerciais (@lid) 
                    nem grupos (@g.us).
                  examples:
                    - +55 (21) 99999-9999
                    - +55 21 99999-9999
                    - +55 21 999999999
                    - '+5521999999999'
                    - '5521999999999'
                    - 5521999999999@s.whatsapp.net
      responses:
        '200':
          description: Contato removido com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Contato removido com sucesso
                  removed_contact:
                    type: object
                    properties:
                      jid:
                        type: string
                        description: 'ID único do contato no WhatsApp (formato: número@s.whatsapp.net)'
                        example: 5511999999999@s.whatsapp.net
                      phone:
                        type: string
                        description: Número de telefone removido
                        example: '5511999999999'
        '400':
          description: Dados inválidos na requisição
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Número de telefone inválido
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
        '404':
          description: Contato não encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Contato não encontrado na agenda
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erro ao remover contato
  /chat/details:
    post:
      tags:
        - Contatos
      summary: Obter Detalhes Completos
      description: >
        Retorna informações **completas** sobre um contato ou chat, incluindo **todos os campos disponíveis** do modelo
        Chat.


        ### Funcionalidades:

        - **Retorna chat completo**: Todos os campos do modelo Chat (mais de 60 campos)

        - **Busca informações para contatos individuais e grupos**

        - **URLs de imagem em dois tamanhos**: preview (menor) ou full (original)

        - **Combina informações de diferentes fontes**: WhatsApp, contatos salvos, leads

        - **Atualiza automaticamente dados desatualizados** no banco


        ### Campos Retornados:

        - **Informações básicas**: id, wa_fastid, wa_chatid, owner, name, phone

        - **Dados do WhatsApp**: wa_name, wa_contactName, wa_archived, wa_isBlocked, etc.

        - **Dados de lead/CRM**: lead_name, lead_email, lead_status, lead_field01-20, etc.

        - **Informações de grupo**: wa_isGroup, wa_isGroup_admin, wa_isGroup_announce, etc.

        - **Chatbot**: chatbot_summary, chatbot_lastTrigger_id, chatbot_disableUntil, etc.

        - **Configurações**: wa_muteEndTime, wa_isPinned, wa_unreadCount, etc.


        **Comportamento**:

        - Para contatos individuais:
          - Busca nome verificado do WhatsApp
          - Verifica nome salvo nos contatos
          - Formata número internacional
          - Calcula grupos em comum
        - Para grupos:
          - Busca nome do grupo
          - Verifica status de comunidade
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: Número do telefone ou ID do grupo
                  example: '5511999999999'
                preview:
                  type: boolean
                  description: |
                    Controla o tamanho da imagem de perfil retornada:
                    - `true`: Retorna imagem em tamanho preview (menor, otimizada para listagens)
                    - `false` (padrão): Retorna imagem em tamanho full (resolução original, maior qualidade)
                  default: false
              required:
                - number
      responses:
        '200':
          description: Informações completas do chat retornadas com sucesso
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../schemas/chat.yaml#/Chat
                  - type: object
                    properties:
                      wa_common_groups:
                        type: string
                        description: 'Grupos em comum separados por vírgula, formato: nome_grupo(id_grupo)'
                        example: Grupo Família(120363123456789012@g.us),Trabalho(987654321098765432@g.us)
                      imagePreview:
                        type: string
                        description: URL da imagem de perfil em tamanho preview (menor) - apenas se preview=true
                      image:
                        type: string
                        description: URL da imagem de perfil em tamanho full (resolução original) - apenas se preview=false
              examples:
                contact_example:
                  summary: Contato individual
                  description: Exemplo de resposta para um contato individual
                  value:
                    id: r1a2b3c4d5e6f7
                    wa_fastid: admin:5511999999999
                    wa_chatid: 5511999999999@s.whatsapp.net
                    wa_name: João Silva
                    name: João Silva
                    phone: +55 11 99999-9999
                    owner: admin
                    wa_archived: false
                    wa_isBlocked: false
                    wa_isGroup: false
                    lead_name: João
                    lead_fullName: João Silva
                    lead_email: joao@exemplo.com
                    lead_status: ativo
                    wa_contactName: João Silva
                    wa_common_groups: Grupo Família(120363123456789012@g.us),Trabalho(987654321098765432@g.us)
                    image: https://pps.whatsapp.net/v/t61.24694-24/12345_image.jpg
                group_example:
                  summary: Grupo
                  description: Exemplo de resposta para um grupo
                  value:
                    id: r9z8y7x6w5v4u3
                    wa_fastid: admin:120363123456789012@g.us
                    wa_chatid: 120363123456789012@g.us
                    wa_name: Grupo Família
                    name: Grupo Família
                    phone: ''
                    owner: admin
                    wa_archived: false
                    wa_isBlocked: false
                    wa_isGroup: true
                    wa_isGroup_admin: true
                    wa_isGroup_announce: false
                    wa_isGroup_community: false
                    wa_isGroup_member: true
                    image: https://pps.whatsapp.net/v/t61.24694-24/67890_group.jpg
        '400':
          description: Payload inválido ou número inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Invalid request payload
        '401':
          description: Token não fornecido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Unauthorized
        '500':
          description: Erro interno do servidor ou sessão não iniciada
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No session
  /chat/check:
    post:
      tags:
        - Contatos
      summary: Verificar Números no WhatsApp
      description: |
        Verifica se números fornecidos estão registrados no WhatsApp e retorna informações detalhadas.

        ### Funcionalidades:
        - Verifica múltiplos números simultaneamente
        - Suporta números individuais e IDs de grupo
        - Retorna nome verificado quando disponível
        - Identifica grupos e comunidades
        - Verifica subgrupos de comunidades

        **Comportamento específico**:
        - Para números individuais:
          - Verifica registro no WhatsApp
          - Retorna nome verificado se disponível
          - Normaliza formato do número
        - Para grupos:
          - Verifica existência
          - Retorna nome do grupo
          - Retorna id do grupo de anúncios se buscado por id de comunidade
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                numbers:
                  type: array
                  items:
                    type: string
                  description: Lista de números ou IDs de grupo para verificar
                  example:
                    - '5511999999999'
                    - 123456789@g.us
      responses:
        '200':
          description: Resultado da verificação
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    query:
                      type: string
                      description: Número/ID original consultado
                    jid:
                      type: string
                      description: JID do WhatsApp
                    lid:
                      type: string
                      description: LID do WhatsApp
                    isInWhatsapp:
                      type: boolean
                      description: Indica se está no WhatsApp
                    verifiedName:
                      type: string
                      description: Nome verificado se disponível
                    groupName:
                      type: string
                      description: Nome do grupo se aplicável
                    error:
                      type: string
                      description: Mensagem de erro se houver
        '400':
          description: Payload inválido ou sem números
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Missing numbers in payload
        '401':
          description: Sem sessão ativa
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No active session
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: WhatsApp client is not connected
  /label/edit:
    post:
      tags:
        - Etiquetas
      summary: Editar etiqueta
      description: |
        Edita uma etiqueta existente na instância.
        Permite alterar nome, cor ou deletar a etiqueta.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                labelid:
                  type: string
                  description: ID da etiqueta a ser editada
                  example: '25'
                name:
                  type: string
                  description: Novo nome da etiqueta
                  example: responder editado
                color:
                  type: integer
                  description: Código numérico da nova cor (0-19)
                  minimum: 0
                  maximum: 19
                  example: 2
                delete:
                  type: boolean
                  description: Indica se a etiqueta deve ser deletada
                  example: false
              required:
                - labelid
      responses:
        '200':
          description: Etiqueta editada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: Label edited
        '400':
          description: Payload inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: invalid payload
        '500':
          description: Erro interno do servidor ou sessão inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: error editing label
  /labels:
    get:
      tags:
        - Etiquetas
      summary: Buscar todas as etiquetas
      description: |
        Retorna a lista completa de etiquetas da instância.
      responses:
        '200':
          description: Lista de etiquetas retornada com sucesso
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/label.yaml#/Label
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch labels from database
  /quickreply/edit:
    post:
      tags:
        - Respostas Rápidas
      summary: Criar, atualizar ou excluir resposta rápida
      description: |
        Gerencia templates de respostas rápidas para agilizar o atendimento. Suporta mensagens de texto e mídia.

        - Para criar: não inclua o campo `id`
        - Para atualizar: inclua o `id` existente
        - Para excluir: defina `delete: true` e inclua o `id`

        Observação: Templates originados do WhatsApp (onWhatsApp=true) não podem ser modificados ou excluídos.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - shortCut
                - type
              properties:
                id:
                  type: string
                  description: Necessário para atualizações/exclusões, omitir para criação
                  example: rb9da9c03637452
                delete:
                  type: boolean
                  description: Definir como true para excluir o template
                  default: false
                shortCut:
                  type: string
                  description: Atalho para acesso rápido ao template
                  example: saudacao1
                type:
                  type: string
                  enum:
                    - text
                    - audio
                    - myaudio
                    - ptt
                    - document
                    - video
                    - image
                  description: Tipo da mensagem
                text:
                  type: string
                  description: Obrigatório para mensagens do tipo texto
                  example: Olá! Como posso ajudar hoje?
                file:
                  type: string
                  description: URL ou Base64 para tipos de mídia
                  example: https://exemplo.com/arquivo.pdf
                docName:
                  type: string
                  description: Nome do arquivo opcional para tipo documento
                  example: apresentacao.pdf
      responses:
        '200':
          description: Operação concluída com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Operação concluída com sucesso
                  quickReplies:
                    type: array
                    items:
                      $ref: ../schemas/quick_reply.yaml#/QuickReply
        '400':
          description: Requisição inválida (erro de validação)
        '403':
          description: Não é possível modificar template originado do WhatsApp
        '404':
          description: Template não encontrado
        '500':
          description: Erro no servidor
  /quickreply/showall:
    get:
      tags:
        - Respostas Rápidas
      summary: Listar todas as respostas rápidas
      description: Retorna todas as respostas rápidas cadastradas para a instância autenticada
      responses:
        '200':
          description: Lista de respostas rápidas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ../schemas/quick_reply.yaml#/QuickReply
        '500':
          description: Erro no servidor
  /call/make:
    post:
      tags:
        - Chamadas
      summary: Iniciar chamada de voz
      description: >
        Inicia uma chamada de voz para um contato específico. Este endpoint permite:

        1. Iniciar chamadas de voz para contatos

        2. Funciona apenas com números válidos do WhatsApp

        3. O contato receberá uma chamada de voz


        **Nota**: O telefone do contato tocará normalmente, mas ao contato atender, ele não ouvirá nada, e você também
        não ouvirá nada. 

        Este endpoint apenas inicia a chamada, não estabelece uma comunicação de voz real.


        Exemplo de requisição:

        ```json

        {
          "number": "5511999999999"
        }

        ```


        Exemplo de resposta:

        ```json

        {
          "response": "Call successful"
        }

        ```


        Erros comuns:

        - 401: Token inválido ou expirado

        - 400: Número inválido ou ausente

        - 500: Erro ao iniciar chamada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: 'Número do contato no formato internacional (ex: 5511999999999)'
                  example: '5511999999999'
              required:
                - number
      responses:
        '200':
          description: Chamada iniciada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                    example: Call successful
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
                    examples:
                      missing_number: missing number in payload
                      invalid_number: invalid number JID
        '401':
          description: Token inválido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro de autenticação
                    example: client not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro interno
                    example: 'error making call: network timeout'
  /call/reject:
    post:
      tags:
        - Chamadas
      summary: Rejeitar chamada recebida
      description: |
        Rejeita uma chamada recebida do WhatsApp. Este endpoint permite:
        1. Rejeitar chamadas de voz ou vídeo recebidas
        2. Necessita do número do contato que está ligando
        3. Necessita do ID da chamada para identificação

        Exemplo de requisição:
        ```json
        {
          "number": "5511999999999",
          "id": "ABEiGmo8oqkAcAKrBYQAAAAA_1"
        }
        ```

        Exemplo de resposta:
        ```json
        {
          "response": "Call rejected"
        }
        ```

        Erros comuns:
        - 401: Token inválido ou expirado
        - 400: Número inválido ou ID da chamada ausente
        - 500: Erro ao rejeitar chamada
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                number:
                  type: string
                  description: 'Número do contato no formato internacional (ex: 5511999999999)'
                  example: '5511999999999'
                id:
                  type: string
                  description: ID único da chamada a ser rejeitada
                  example: ABEiGmo8oqkAcAKrBYQAAAAA_1
              required:
                - number
                - id
      responses:
        '200':
          description: Chamada rejeitada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    description: Mensagem de confirmação
                    example: Call rejected
        '400':
          description: Requisição inválida
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro
                    examples:
                      missing_number: missing number in payload
                      missing_id: missing id in payload
                      invalid_number: invalid number
        '401':
          description: Token inválido ou expirado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro de autenticação
                    example: client not found
        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Descrição do erro interno
                    example: 'error rejecting call: timeout'
  /chatwoot/config:
    get:
      tags:
        - Integração Chatwoot
      summary: Obter configuração do Chatwoot
      description: |
        Retorna a configuração atual da integração com Chatwoot para a instância.

        ### Funcionalidades:
        - Retorna todas as configurações do Chatwoot incluindo credenciais
        - Mostra status de habilitação da integração
        - Útil para verificar configurações atuais antes de fazer alterações
      responses:
        '200':
          description: Configuração obtida com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  chatwoot_enabled:
                    type: boolean
                    description: Se a integração com Chatwoot está habilitada
                    example: true
                  chatwoot_url:
                    type: string
                    description: URL base da instância Chatwoot
                    example: https://app.chatwoot.com
                  chatwoot_account_id:
                    type: integer
                    format: int64
                    description: ID da conta no Chatwoot
                    example: 1
                  chatwoot_inbox_id:
                    type: integer
                    format: int64
                    description: ID da inbox no Chatwoot
                    example: 5
                  chatwoot_access_token:
                    type: string
                    description: Token de acesso da API Chatwoot
                    example: pXXGHHHyJPYHYgWHJHYHgJjj
                  chatwoot_ignore_groups:
                    type: boolean
                    description: Se deve ignorar mensagens de grupos na sincronização
                    example: false
                  chatwoot_sign_messages:
                    type: boolean
                    description: Se deve assinar mensagens enviadas para o WhatsApp
                    example: true
                  chatwoot_create_new_conversation:
                    type: boolean
                    description: Sempre criar nova conversa ao invés de reutilizar conversas existentes
                    example: false
        '401':
          description: Token inválido/expirado
        '500':
          description: Erro interno do servidor
    put:
      tags:
        - Integração Chatwoot
      summary: Atualizar configuração do Chatwoot
      description: |
        Atualiza a configuração da integração com Chatwoot para a instância.

        ### Funcionalidades:
        - Configura todos os parâmetros da integração Chatwoot
        - Reinicializa automaticamente o cliente Chatwoot quando habilitado
        - Retorna URL do webhook para configurar no Chatwoot
        - Sincronização bidirecional de mensagens novas entre WhatsApp e Chatwoot
        - Sincronização automática de contatos (nome e telefone)
        - Atualização automática LID → PN (Local ID para Phone Number)
        - Sistema de nomes inteligentes com til (~)

        ### Configuração no Chatwoot:
        1. Após configurar via API, use a URL retornada no webhook settings da inbox no Chatwoot
        2. Configure como webhook URL na sua inbox do Chatwoot
        3. A integração ficará ativa e sincronizará mensagens e contatos automaticamente

        ### 🏷️ Sistema de Nomes Inteligentes:
        - **Nomes com til (~)**: São atualizados automaticamente quando o contato modifica seu nome no WhatsApp
        - **Nomes específicos**: Para definir um nome fixo, remova o til (~) do nome no Chatwoot
        - **Exemplo**: "~João Silva" será atualizado automaticamente, "João Silva" (sem til) permanecerá fixo
        - **Atualização LID→PN**: Contatos migram automaticamente de Local ID para Phone Number quando disponível
        - **Sem duplicação**: Durante a migração LID→PN, não haverá duplicação de conversas
        - **Respostas nativas**: Todas as respostas dos agentes aparecem nativamente no Chatwoot

        ### 🚧 AVISO IMPORTANTE - INTEGRAÇÃO BETA:
        - **Fase Beta**: Esta integração está em fase de desenvolvimento e testes
        - **Uso por conta e risco**: O usuário assume total responsabilidade pelo uso
        - **Recomendação**: Teste em ambiente não-produtivo antes de usar em produção
        - **Suporte limitado**: Funcionalidades podem mudar sem aviso prévio

        ### ⚠️ Limitações Conhecidas:
        - **Sincronização de histórico**: Não implementada - apenas mensagens novas são sincronizadas
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
                  description: Habilitar/desabilitar integração com Chatwoot
                  example: true
                url:
                  type: string
                  description: URL base da instância Chatwoot (sem barra final)
                  example: https://app.chatwoot.com
                access_token:
                  type: string
                  description: Token de acesso da API Chatwoot (obtido em Profile Settings > Access Token)
                  example: pXXGHHHyJPYHYgWHJHYHgJjj
                account_id:
                  type: integer
                  format: int64
                  description: ID da conta no Chatwoot (visível na URL da conta)
                  example: 1
                inbox_id:
                  type: integer
                  format: int64
                  description: ID da inbox no Chatwoot (obtido nas configurações da inbox)
                  example: 5
                ignore_groups:
                  type: boolean
                  description: Ignorar mensagens de grupos do WhatsApp na sincronização
                  example: false
                sign_messages:
                  type: boolean
                  description: Assinar mensagens enviadas para WhatsApp com identificação do agente
                  example: true
                create_new_conversation:
                  type: boolean
                  description: Sempre criar nova conversa ao invés de reutilizar conversas existentes
                  example: false
              required:
                - enabled
                - url
                - access_token
                - account_id
                - inbox_id
      responses:
        '200':
          description: Configuração atualizada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Mensagem de confirmação
                    example: 'Chatwoot config updated successfully, put this URL in Chatwoot inbox webhook settings:'
                  chatwoot_inbox_webhook_url:
                    type: string
                    description: URL do webhook para configurar na inbox do Chatwoot
                    example: https://sua-api.com/chatwoot/webhook/inst_abc123
        '400':
          description: Dados inválidos no body da requisição
        '401':
          description: Token inválido/expirado
        '500':
          description: Erro interno ao salvar configuração
